<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Nondestructive detection of photonic qubits</title><meta name="author" content="Dominik Niemietz"/><meta name="description" content="Nature, doi:10.1038/s41586-021-03290-z"/><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 h2 { color: black; font-family:"Bookman Old Style", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 14pt; }
 h1 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 26pt; }
 .s1 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s2 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s3 { color: black; font-family:"Arial Black", sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8pt; }
 .s4 { color: black; font-family:"Arial Black", sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 4.5pt; vertical-align: 3pt; }
 .s5 { color: black; font-family:"Arial Black", sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 4.5pt; }
 .s6 { color: black; font-family:"MS Gothic", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; vertical-align: 3pt; }
 .s7 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s9 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; }
 .s10 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; }
 .p, p { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; margin:0pt; }
 .s11 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 3pt; }
 .s12 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s13 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s14 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s15 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3.5pt; vertical-align: 2pt; }
 .s16 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s17 { color: black; font-family:"MS Gothic", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: 2pt; }
 .a { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s18 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8pt; vertical-align: -1pt; }
 .s19 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8pt; }
 .s20 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s21 { color: #3B73B8; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s22 { color: #6DB42E; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s23 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s24 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s25 { color: black; font-family:Symbol, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s26 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; vertical-align: -1pt; }
 .s27 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; vertical-align: 1pt; }
 .s28 { color: #1D1D1D; font-family:Garamond, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s29 { color: #1D1D1D; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s30 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; vertical-align: 2pt; }
 .s31 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; vertical-align: 4pt; }
 .s32 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s33 { color: #1D1D1D; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; }
 .s34 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; vertical-align: -2pt; }
 .s35 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; vertical-align: 2pt; }
 .s36 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 4pt; vertical-align: -2pt; }
 .s37 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s38 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7pt; }
 .s39 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s41 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; vertical-align: -1pt; }
 .s42 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: -1pt; }
 .s43 { color: black; font-family:Cambria, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s44 { color: black; font-family:Cambria, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: -1pt; }
 .s45 { color: black; font-family:Cambria, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s46 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 3pt; }
 .s47 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: -2pt; }
 .s48 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s49 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 1pt; }
 .s50 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: -4pt; }
 .s51 { color: #1D1D1D; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s52 { color: #0B7733; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s53 { color: #F9B015; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s54 { color: #E5231F; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s55 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8pt; vertical-align: 1pt; }
 .s56 { color: #1D1D1D; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 2pt; }
 .s57 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s58 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s59 { color: #1D1D1D; font-family:Garamond, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s60 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 1pt; }
 .s61 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s63 { color: black; font-family:Cambria, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 4.5pt; vertical-align: -1pt; }
 .s64 { color: black; font-family:Cambria, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 4.5pt; }
 .s65 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; vertical-align: -1pt; }
 .s66 { color: black; font-family:Cambria, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5.5pt; }
 .s67 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; }
 .s69 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: 1pt; }
 .s70 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; vertical-align: -1pt; }
 .s71 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; vertical-align: -3pt; }
 .s72 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 4pt; }
 .s73 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8pt; vertical-align: -5pt; }
 .s74 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s75 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: -2pt; }
 .s76 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8pt; }
 .s77 { color: #0B66B0; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s78 { color: #004C95; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s79 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s80 { color: black; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s81 { color: #029939; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s82 { color: #E10814; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s83 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 2pt; }
 .s84 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: -2pt; }
 .s85 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s86 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8pt; vertical-align: -3pt; }
 .s87 { color: black; font-family:Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; }
 .s88 { color: black; font-family:Symbol, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s89 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 2pt; }
 .s90 { color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: -2pt; }
 .s91 { color: #1D1D1D; font-family:"Bookman Old Style", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s92 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s93 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; vertical-align: 3pt; }
 h4 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9.5pt; }
 .s95 { color: black; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s96 { color: black; font-family:"Arial Black", sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 6pt; }
 .s97 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3.5pt; vertical-align: -1pt; }
 .s98 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3.5pt; }
 h3 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 .s99 { color: black; font-family:"Book Antiqua", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8.5pt; }
 .s100 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; vertical-align: 1pt; }
 .s101 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: 3pt; }
 .s102 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: 6pt; }
 .s103 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; vertical-align: 4pt; }
 .s104 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: -3pt; }
 .s105 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; vertical-align: 2pt; }
 .s106 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; vertical-align: 2pt; }
 .s107 { color: black; font-family:Cambria, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: 3pt; }
 .s108 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: 1pt; }
 .s109 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: -1pt; }
 .s110 { color: black; font-family:Cambria, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 4pt; vertical-align: -1pt; }
 .s111 { color: black; font-family:Cambria, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 4pt; }
 .s112 { color: black; font-family:Haettenschweiler, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s113 { color: black; font-family:"Arial Black", sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .s114 { color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s115 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; vertical-align: -1pt; }
 .s116 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4.5pt; }
 .s117 { color: black; font-family:"Arial Narrow", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; vertical-align: -2pt; }
 .s118 { color: black; font-family:"Arial Narrow", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 li {display: block; }
 #l1 {padding-left: 0pt;counter-reset: c1 0; }
 #l1> li:before {counter-increment: c1; content: counter(c1, lower-latin)" "; color: #1D1D1D; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8pt; }
 #l2 {padding-left: 0pt;counter-reset: c2 0; }
 #l2> li:before {counter-increment: c2; content: counter(c2, decimal)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
</style></head><body><p style="text-indent: 0pt;text-align: left;"><span><img width="0" height="954" alt="image" src="Nondestructive detection of photonic/Image_001.png"/></span></p><h2 style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">Article</h2><p style="text-indent: 0pt;text-align: left;"><span><img width="741" height="0" alt="image" src="Nondestructive detection of photonic/Image_002.png"/></span></p><h1 style="padding-top: 5pt;padding-left: 11pt;text-indent: 0pt;line-height: 28pt;text-align: left;"><a name="bookmark0">Nondestructive detection of photonic qubits</a></h1><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="703" height="0" alt="image" src="Nondestructive detection of photonic/Image_003.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="222" height="0" alt="image" src="Nondestructive detection of photonic/Image_004.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="222" height="0" alt="image" src="Nondestructive detection of photonic/Image_005.png"/></span></p><p class="s2" style="padding-top: 2pt;padding-left: 11pt;text-indent: 0pt;line-height: 175%;text-align: left;"><a href="https://doi.org/10.1038/s41586-021-03290-z" class="s1" target="_blank">https://doi.org/10.1038/s41586-021-03290-</a>z Received: 4 August 2020</p><p class="s2" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">Accepted: 26 January 2021</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="223" height="0" alt="image" src="Nondestructive detection of photonic/Image_006.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="222" height="0" alt="image" src="Nondestructive detection of photonic/Image_007.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="223" height="19" alt="image" src="Nondestructive detection of photonic/Image_008.png"/></span></p><p class="s2" style="padding-top: 2pt;padding-left: 11pt;text-indent: 0pt;line-height: 175%;text-align: left;">Published online: 24 March 2021 Open access</p><p class="s2" style="text-indent: 0pt;text-align: center;">Check for updates</p><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Dominik Niemietz<span class="s4">1</span><span class="s5"> </span><span class="s6">✉</span>, Pau Farrera<span class="s4">1,</span><span class="s5">2</span>, Stefan Langenfeld<span class="s4">1</span><span class="s5"> </span>&amp; Gerhard Rempe<span class="s4">1</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="461" height="0" alt="image" src="Nondestructive detection of photonic/Image_009.png"/></span></p><p class="s9" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 120%;text-align: left;"><a href="#bookmark14" style=" color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt;">One of the biggest challenges in experimental quantum information is to sustain the fragile superposition state of a qubit</a><span style=" color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: 4pt;">1</span><a href="#bookmark15" style=" color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt;">. Long lifetimes can be achieved for material qubit carriers as memories</a><span style=" color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: 4pt;">2</span><a href="#bookmark16" style=" color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt;">, at least in principle, but not for propagating photons that are rapidly lost by absorption, diffraction or scattering</a><span style=" color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: 4pt;">3</span><a href="#bookmark17" style=" color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt;">. The loss problem can be mitigated with a nondestructive photonic qubit detector that heralds the photon without destroying the encoded qubit. Such a detector is envisioned to facilitate protocols in which distributed tasks depend on the successful dissemination of photonic qubits</a><span style=" color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: 4pt;">4</span><a href="#bookmark18" class="s10">,</a>5<a href="#bookmark19" style=" color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt;">, improve loss-sensitive qubit measurements</a><span style=" color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: 4pt;">6</span><a href="#bookmark20" class="s10">,</a>7 <a href="#bookmark21" style=" color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt;">and enable certain quantum key distribution attacks</a><span style=" color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: 4pt;">8</span><a href="#bookmark22" style=" color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt;">. Here we demonstrate such a detector based on a single atom in two crossed fibre-based optical resonators, one for qubit-insensitive atom–photon coupling and the other for atomic-state detection</a><span style=" color: black; font-family:Cambria, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: 4pt;">9</span><span class="s7">. We achieve a nondestructive detection efficiency upon qubit survival of 79 ± 3 per cent and a photon survival probability of 31 ± 1 per cent, and we preserve the qubit information with a fidelity of 96.2 ± 0.3 per cent. To illustrate the potential of our detector, we show that it can, with the current parameters, improve the rate and fidelity of long-distance entanglement and quantum state distribution compared to previous methods, provide resource optimization via qubit amplification and enable detection- loophole-free Bell tests.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="703" height="0" alt="image" src="Nondestructive detection of photonic/Image_010.png"/></span></p><p class="s46" style="padding-top: 2pt;padding-left: 11pt;text-indent: 0pt;line-height: 113%;text-align: justify;"><a href="#bookmark14" class="s14">The qubit is the elementary information unit in quantum information science</a>1<a href="#bookmark23" class="s14">. Encoding a qubit into two modes of a single photon allows the distribution of quantum information over long distances. This has enabled a range of experiments, from fundamental tests of quantum physics</a><a href="#bookmark23" class="s11">1</a><a href="#bookmark24" class="s12">0,</a><span class="s13">11 </span><a href="#bookmark16" class="s14">to applications related to quantum communication</a>3<span class="s13"> </span><a href="#bookmark22" class="s14">and quantum networks</a>9<a href="#bookmark25" class="s12">,</a><span class="s13">12</span><span class="p">. However, unavoidable absorption, diffraction and scattering losses of long transmission channels severely limit the transfer distance. It is important to emphasize that these losses typically occur independent of the state of the qubit that is encoded in the two optical modes, be it time bins or light polarization. In fact, in optical fibres the loss rate of the qubit carrier, the photon, can be many orders of magnitude larger than all decoherence rates of the encoded qubit. By contrast, material qubit carriers are rarely lost in any quantum informa- tion protocol demonstrated so far. For photons, the loss is fundamental and cannot be eliminated in any of the envisioned quantum informa- tion processing tasks. However, the loss effect could be mitigated by tracking the photon without destroying the encoded qubit, provided a nondestructive photonic qubit detector (NPQD) is available.</span></p><p style="padding-left: 11pt;text-indent: 8pt;line-height: 114%;text-align: justify;"><a href="#bookmark10" class="s14">Once at hand, such an NPQD could communicate to both the send- ing and the receiving nodes of a quantum network whether or not a photonic qubit has been lost along the way (Fig. </a>1a). This loss monitor- ing has several advantages: first, it allows quantum communication schemes to stop the execution of further operations and restart the protocol when the qubit-carrying photon was found to be lost along the communication channel. This is important when these operations are time-expensive or involve the use of precious resources such as</p><p class="s46" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;"><a href="#bookmark26" class="s14">long-distance entanglement for quantum teleportation. Second, the detector can precertify the arrival of a photonic qubit immediately before a planned quantum measurement so that the latter is only conducted when the qubit is present at the measurement input. This enables us to perform loss-sensitive qubit measurements even in the presence of high transmission losses. Examples are measurements limited by the detection noise, photon-receiving repeater schemes</a>13<a href="#bookmark19" class="s14">, or experiments where qubit loss leads to loopholes as in Bell tests</a>6<a href="#bookmark20" class="s12">,</a><span class="s13">7</span><a href="#bookmark27" class="s14">. The last are of key importance for device-independent quantum key distribution</a>14<span class="p">.</span></p><p class="s46" style="padding-left: 5pt;text-indent: 8pt;line-height: 112%;text-align: justify;"><a href="#bookmark28" class="s14">Despite recent progress on the quantum nondemolition detection of optical and microwave fields</a>15<a href="#bookmark30" class="s12">–</a><span class="s13">21</span><a href="#bookmark31" class="s14">, the nondestructive detection of the photonic energy without projection of the encoded qubit infor- mation remains an outstanding challenge. Some work related to the experimental implementation of NPQDs in the optical domain has been conducted, such as the nondestructive detection of bright two-mode light pulses using cross-phase modulation</a>22<a href="#bookmark32" class="s14">, although this scheme operates far from the single-photon qubit regime. Another approach makes use of parametric down-conversion of the incoming qubit pho- ton</a>23<a href="#bookmark33" class="s14">, where one down-converted photon heralds the qubit presence and the other provides the qubit information. This approach shows a severely limited efficiency (−76 dB), owing to the small conversion efficiency of the applied photon-splitting process. Other related work includes heralded qubit amplifiers, which use two ancilla photons that interfere with the input signal</a>24<span class="p">. However, interference requires prior knowledge about the pulse shape and arrival time and therefore</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="703" height="0" alt="image" src="Nondestructive detection of photonic/Image_011.png"/></span></p><p class="s15" style="padding-left: 11pt;text-indent: 0pt;line-height: 9pt;text-align: left;">1<span class="s16">Max-Planck-Institut für Quantenoptik, Garching, Germany. </span>2<span class="s16">ICFO—Institut de Ciencies Fotoniques, The Barcelona Institute of Science and Technology, Castelldefels, Spain. </span><span class="s17">✉</span><a href="mailto:dominik.niemietz@mpq.mpg.de" class="a" target="_blank">e-mail: dominik. niemietz@mpq.mpg.de</a></p><p style="text-indent: 0pt;text-align: left;"><span><img width="0" height="926" alt="image" src="Nondestructive detection of photonic/Image_012.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="692" height="335" alt="image" src="Nondestructive detection of photonic/Image_013.png"/></span></p><p class="s18" style="padding-top: 3pt;padding-left: 62pt;text-indent: -47pt;line-height: 8pt;text-align: left;">a                  <span class="s19"> </span><span class="s20">Classical communication channel Transmitted (lost) photonic qubit</span></p><p class="s20" style="padding-top: 1pt;padding-left: 62pt;text-indent: 0pt;text-align: left;">Qubit communication channel</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 117%;text-align: left;">Quantum network node Optical circulator NPQD</p><p class="s19" style="padding-top: 3pt;padding-left: 13pt;text-indent: 0pt;text-align: left;">b</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s21" style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Qubit cavity</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="text-indent: 0pt;text-align: right;">SPD</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s22" style="padding-top: 4pt;padding-left: 19pt;text-indent: -13pt;line-height: 6pt;text-align: left;">State-detection cavity</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 33pt;text-indent: -4pt;line-height: 6pt;text-align: left;">Microwave antenna</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 10pt;text-indent: 0pt;text-align: left;">NPBS</p><p class="s23" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">R <span class="s20">= 0.5%</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">I<span class="s25"></span><span class="s26">ph</span><span class="s27">)</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 7pt;text-align: left;">A<span class="s20">/2</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s28" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">A<span class="s20">/4</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">PBS</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SPD</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s19" style="padding-top: 3pt;padding-left: 14pt;text-indent: 0pt;line-height: 9pt;text-align: left;">c                                                                   d</p><p class="s23" style="padding-left: 31pt;text-indent: 0pt;line-height: 5pt;text-align: left;">F<span class="s29">&#39; </span><span class="s20">= 3</span></p><p class="s30" style="padding-top: 2pt;padding-left: 14pt;text-indent: 0pt;text-align: left;">5<span class="s31">2</span>P<span class="s32">3/2</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="text-indent: 0pt;text-align: left;">F<span class="s29">&#39; </span><span class="s20">= 2</span></p><p class="s33" style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">I<span class="s23">e</span><span class="s34">a</span><span class="s29">)</span></p><p class="s19" style="padding-top: 2pt;text-indent: 0pt;text-align: right;">e</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s33" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">I<span class="s20">1</span><span class="s34">a</span><span class="s29">)</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 14pt;text-indent: 0pt;text-align: left;">5<span class="s35">2</span>S</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s32" style="text-indent: 0pt;text-align: left;">1/2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="text-indent: 0pt;text-align: left;">F <span class="s20">= 2</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s23" style="text-indent: 0pt;text-align: left;">F <span class="s20">= 1</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s33" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">I<span class="s20">1</span><span class="s34">a</span><span class="s29">)</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s33" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">I<span class="s20">0</span><span class="s34">a</span><span class="s29">)</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 1pt;text-indent: 0pt;line-height: 7pt;text-align: left;">+3</p><p style="text-indent: 0pt;text-align: left;"/><p class="s33" style="padding-left: 5pt;text-indent: 0pt;line-height: 129%;text-align: left;">I<span class="s20">1</span><span class="s34">a</span><span class="s29">) </span>I<span class="s20">0</span><span class="s34">a</span><span class="s29">)</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s33" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">I<span class="s20">0</span><span class="s34">a</span><span class="s29">)</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="text-indent: 0pt;text-align: center;"><span class="s33">I</span>0<span class="s34">a</span><span class="s29">) </span>+ <span class="s33">I</span>1<span class="s34">a</span><span class="s29">)</span></p><p class="s29" style="padding-top: 1pt;text-indent: 0pt;line-height: 7pt;text-align: center;">  <span class="s20">2</span></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 8pt;text-align: center;"><span class="s33">I</span>0<span class="s34">a</span><span class="s29">) </span>– <span class="s33">I</span>1<span class="s34">a</span><span class="s29">)</span></p><p class="s29" style="padding-top: 1pt;text-indent: 0pt;text-align: right;">  <span class="s20">2</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s33" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">I<span class="s20">0</span><span class="s34">a</span><span class="s29">)                            </span>I<span class="s20">0</span><span class="s34">a</span><span class="s29">)</span></p><p class="s23" style="padding-top: 4pt;padding-left: 14pt;text-indent: 0pt;text-align: left;">m<span class="s36">F             </span><span class="s37"> </span><span class="s20">3</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">–2       –1        0</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">+1       +2</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">I                                                  II                                   III                                  IV</p><p class="s39" style="padding-top: 10pt;padding-left: 11pt;text-indent: 0pt;line-height: 121%;text-align: left;"><a name="bookmark1"><b>Fig. 1 | Nondestructive photonic qubit detector. a</b></a>, A quantum network including NPQDs. Detected and non-detected qubit photon events are coloured in green and red, respectively. <b>b</b>, The NPQD set-up showing the crossed optical-fibre cavities together with the microwave antenna and the state-detection beam (red solid line). Input photonic qubits (red arrows) are reflected by the NPQD via a highly transmittive non-polarizing beam splitter (NPBS, with a reflection of <i>R </i>= 0.5%) and later sent to a qubit measurement<a name="bookmark10">&zwnj;</a></p><p class="s46" style="padding-top: 17pt;padding-left: 11pt;text-indent: 0pt;line-height: 11pt;text-align: justify;"><a href="#bookmark34" class="s14">restricts the range of possible applications. Finally, our previous work on heralded quantum memories</a>25<a href="#bookmark35" class="s12">,</a><span class="s13">26 </span><a href="#bookmark36" class="s14">can, in combination with readout, be used to herald photonic qubits. But the single-photon herald signal is highly sensitive to losses and the system therefore has a small detec- tion efficiency. It is important to point out that (in contrast to the NPQD reported here) all mentioned qubit-heralding schemes destroy the original incoming photon waveform, which is important in applica- tions where synchronization and interference matter, as for time-bin qubits or in linear optical quantum computing</a>27<span class="p">.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s39" style="padding-left: 5pt;text-indent: 0pt;line-height: 119%;text-align: left;">set-up (black dashed rectangle) including <i>λ</i>/2 and <i>λ</i>/4 waveplates, a polarizing beam splitter (PBS) and single-photon detectors (SPD). <b>c</b>, Atomic-level scheme together with the qubit coupling transitions (dashed arrows). <b>d</b>, The atomic state affects the entrance of the qubit photon into the qubit cavity. |<i>e</i><span class="s41">a</span>⟩ denotes the atomic excited state that is coupling to |0<span class="s41">a</span>⟩ via the qubit cavity modes.</p><p class="s38" style="padding-left: 5pt;text-indent: 0pt;line-height: 7pt;text-align: left;">e<span class="s39">, Bloch spheres I–IV show the atomic state for different stages of the ideal</span></p><p class="s39" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">NPQD scheme.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 111%;text-align: justify;">Finally, a π/2 pulse rotates the atomic state to |0<span class="s42">a</span>⟩ (|1<span class="s42">a</span>⟩) in the case of one (no) qubit photon (Bloch sphere III), enabling us to witness the atomic phase flip by means of deterministic atomic-state detection (Bloch sphere IV).</p><p style="padding-left: 5pt;text-indent: 8pt;line-height: 111%;text-align: justify;"><a href="#bookmark29" class="s14">Compared to previous experiments</a><span class="s46">18</span>, our scheme is made possible by two key ingredients: first, we choose a state |0<span class="s42">a</span>⟩ ≔ |<i>F </i>= 1, <i>m</i><span class="s44">F</span><span class="s45"> </span>= 0⟩ so that the qubit cavity, with its two left and right circularly polarized and frequency-degenerate eigenmodes, couples strongly to two atomic</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 5pt;text-align: left;">transitions, |0 ⟩ ↔ |<i>F</i>′ = 2, <i>m  </i><a href="#bookmark10" class="s14">= ±1⟩ (Fig. </a>1c). Here, <i>F </i>and <i>F</i>′ denote the</p><p class="s13" style="padding-left: 331pt;text-indent: 0pt;line-height: 1pt;text-align: left;">a                                        <i>F</i></p><p style="padding-left: 11pt;text-indent: 8pt;line-height: 114%;text-align: justify;">We here demonstrate the implementation of an NPQD using a single atom strongly coupled to the modes oftwo independent optical resona- tors. Photonic polarization qubits are sent onto the qubit cavity where they are reflected while imprinting a π phase shift on an atomic super- position state. By coherent manipulation of the atomic superposition state, phase information is mapped into population information, which can be read out using the state-detection cavity. This signal heralds the nondestructive detection of the photonic qubit reflected off the qubit cavity. We show that the strong atom–photon interaction provided by both cavities allows for an efficient NPQD. We also prove that the reflec- tion mechanism preserves the temporal waveform of the light pulse, which is of key importance for photonic time-bin qubits.</p><p class="s46" style="padding-left: 11pt;text-indent: 8pt;line-height: 107%;text-align: justify;"><a href="#bookmark37" class="s14">The qubit–atom interaction mechanism is, in essence, a single-rail version of the scheme proposed by Duan et al.</a>28<span class="p">. In our case, it starts</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 111%;text-align: justify;">magnitude of the total atomic angular momentum and <i>m</i><span class="s44">F</span><span class="s45"> </span><a href="#bookmark38" class="s14">denote their projection onto the quantization axis. The coupling strengths for both transitions are equal by definition but much smaller than for a cycling transition. We compensate this reduction by using a miniaturized fibre resonator</a><span class="s46">29</span>, achieving a coupling constant <i>g </i>= 2π × (18.6 ± 0.5) MHz and a cooperativity of <i>C </i>= 1.67 ± 0.09 (see Methods). Second, the com- pact lateral size of fibre resonators allows for the integration of a sec- ond crossed optical-fibre resonator with small mode volume. Here, it is used as the state-detection cavity which is tuned to the atomic cycling transition |<i>F </i>= 2⟩ ↔ |<i>F</i>′ = 3⟩, enabling a strong fluorescence sig- nal to be observed from |1<span class="s42">a</span>⟩ ≔ |<i>F </i>= 2, <i>m</i><span class="s44">F</span><span class="s45"> </span>= 0⟩. This is used to distinguish the two atomic states |0<span class="s42">a</span>⟩ and |1<span class="s42">a</span>⟩ with a fidelity of (98.2 ± 0.2)% at a photon-number threshold of one.</p><p style="padding-left: 14pt;text-indent: 0pt;text-align: left;">The physical elements needed to implement the NPQD are shown</p><p style="text-indent: 0pt;text-align: left;"><span><img width="15" height="12" alt="image" src="Nondestructive detection of photonic/Image_014.png"/></span></p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 6pt;text-align: left;">with a <span class="s46">87</span>Rb atom prepared in state(|0 ⟩ + |1 ⟩)/   2  (Bloch sphere I in</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 5pt;text-align: left;"><a href="#bookmark10" class="s14">in Fig. </a>1b. The photon qubit |<i>Ψ</i></p><p style="padding-left: 4pt;text-indent: 0pt;line-height: 5pt;text-align: left;">⟩ first passes a highly transmitting</p><p class="s9" style="padding-left: 62pt;text-indent: 0pt;line-height: 6pt;text-align: center;">a            a</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 109%;text-align: justify;"><a href="#bookmark10" class="s14">Fig. </a>1e). The atomic state |0<span class="s42">a</span><a href="#bookmark10" class="s14">⟩ is strongly coupled to the optical cavity modes, thus preventing a photon from entering the cavity. Instead, the photon reflects from the cavity input mirror (Fig. 1</a>d) so that</p><p style="text-indent: 0pt;text-align: left;"><span><img width="15" height="12" alt="image" src="Nondestructive detection of photonic/Image_015.png"/></span></p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 107%;text-align: justify;">|<i>Ψ</i><span class="s42">ph</span>⟩|0<span class="s42">a</span>⟩ → +|<i>Ψ</i><span class="s42">ph</span>⟩|0<span class="s42">a</span>⟩, where |<i>Ψ</i><span class="s42">ph</span>⟩ denotes a photonic polarization qubit. By contrast, state |1<span class="s42">a</span>⟩ has no transition in resonance with the qubit cavity. Hence, the qubit photon enters the cavity and acquires a π phase shift upon reflection, |<i>Ψ</i><span class="s42">ph</span>⟩|1<span class="s42">a</span>⟩ → −|<i>Ψ</i><span class="s42">ph</span>⟩|1<span class="s42">a</span>⟩. Together, the qubit photon flips the atomic superposition state to(|0<span class="s47">a</span>⟩ − |1<span class="s47">a</span>⟩)/  2 (Bloch sphere II).</p><p class="s13" style="padding-left: 103pt;text-indent: 0pt;line-height: 5pt;text-align: center;">ph</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 114%;text-align: justify;"><a href="#bookmark10" class="s14">non-polarizing beam splitter. Although the non-polarizing beam split- ter is suitable for characterization measurements employing weak coherent pulses, for future implementations using single photons it should be replaced by an efficient optical circulator (Fig. </a>1a). After reflection at the non-polarizing beam splitter, the photon qubit is coupled into a single-mode optical fibre that connects to the qubit fibre cavity where the nondestructive interaction takes place. After reflection, the qubit photon is characterized by state tomography.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="0" height="954" alt="image" src="Nondestructive detection of photonic/Image_016.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="741" height="0" alt="image" src="Nondestructive detection of photonic/Image_017.png"/></span></p><h2 style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">Article</h2><p class="s48" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Counts per time bin</p><p style="text-indent: 0pt;text-align: left;"/><ol id="l1"><li style="padding-top: 6pt;padding-left: 28pt;text-indent: -12pt;text-align: right;"><p class="s49" style="display: inline;">80</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="text-indent: 0pt;text-align: right;">60</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="text-indent: 0pt;text-align: right;">40</p><p style="text-indent: 0pt;text-align: left;"><span><img width="301" height="109" alt="image" src="Nondestructive detection of photonic/Image_018.png"/></span></p><p class="s48" style="padding-top: 23pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">I                  II               III                                  IV</p><p class="s48" style="padding-top: 17pt;text-indent: 0pt;line-height: 6pt;text-align: right;">Atomic</p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">bars) compared to the situation where no qubits are sent (blue bars).</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 22pt;text-align: left;">definition of the NPQD efficiency is ambiguous as it depends on the use the conditional probability of detecting the atom in the qubit-heralding</p><p class="s48" style="padding-left: 57pt;text-indent: 0pt;line-height: 3pt;text-align: left;">Microwave</p><p class="s48" style="padding-left: 32pt;text-indent: -3pt;text-align: left;"><span class="s50">20           </span> <span class="s51">n</span>/2 pulse</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="text-indent: 0pt;line-height: 6pt;text-align: center;">0</p><p class="s48" style="padding-left: 7pt;text-indent: -1pt;line-height: 3pt;text-align: left;">Microwave</p><p class="s51" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">n<span class="s48">/2 pulse</span></p><p class="s48" style="padding-left: 5pt;text-indent: 0pt;line-height: 6pt;text-align: left;">state detection</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">state |0<span class="s42">a</span>⟩, either given a qubit at the qubit cavity output (1<span class="s42">oq</span>), <i>P</i>(0<span class="s42">a</span>|1<span class="s42">oq</span>) =</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">and the photon survival probability <i>η</i><span class="s42">surv</span><span class="s13"> </span>= (31 ± 1)%. Another figure</p><p class="s48" style="padding-left: 61pt;text-indent: 0pt;line-height: 7pt;text-align: left;">–5                     0                      5                     10                    15</p><p class="s48" style="padding-left: 39pt;text-indent: 0pt;line-height: 8pt;text-align: center;">Time (<span class="s51">µ</span>s)</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">of merit for any detector is the dark-count probability, which is <i>p</i><span class="s42">DC</span><span class="s13"> </span>= (3.3 ± 0.2)% for our NPQD.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="334" height="263" alt="image" src="Nondestructive detection of photonic/Image_019.png"/></span></p></li><li style="padding-left: 73pt;text-indent: -56pt;line-height: 9pt;text-align: right;"><p class="s52" style="display: inline;">H</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s53" style="padding-top: 4pt;text-indent: 0pt;text-align: right;">A</p><p class="s54" style="padding-top: 5pt;padding-left: 15pt;text-indent: 0pt;text-align: left;">L</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s53" style="text-indent: 0pt;text-align: right;">D</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s52" style="text-indent: 0pt;text-align: right;">V</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Counts per time bin</p><p style="text-indent: 0pt;text-align: left;"/><p class="s55" style="padding-left: 18pt;text-indent: 0pt;text-align: left;">d    <span class="s19"> </span><span class="s48">1.0</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="padding-left: 35pt;text-indent: 0pt;text-align: center;">0.5</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="padding-top: 4pt;padding-left: 35pt;text-indent: 0pt;line-height: 6pt;text-align: center;">0</p><p class="s19" style="padding-left: 17pt;text-indent: 0pt;line-height: 9pt;text-align: center;">c <span class="s49">1.00</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="padding-left: 25pt;text-indent: 0pt;text-align: center;">0.98</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="padding-top: 5pt;padding-left: 25pt;text-indent: 0pt;text-align: center;">0.96</p><p class="s54" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">R</p><p class="s48" style="padding-top: 1pt;padding-left: 25pt;text-indent: 0pt;text-align: center;">0.94</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="padding-top: 5pt;padding-left: 25pt;text-indent: 0pt;text-align: center;">0.92</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="padding-top: 5pt;padding-left: 25pt;text-indent: 0pt;text-align: center;">0.90</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s56" style="padding-top: 8pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">F<span class="s57">HVRL</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s56" style="padding-top: 7pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">F<span class="s57">AD</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s56" style="padding-top: 8pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">F<span class="s57">all</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s56" style="padding-top: 8pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">F<span class="s58">s</span><span class="s57">,</span><span class="s59">x      </span>F</p><p style="text-indent: 0pt;text-align: left;"><span><img width="10" height="1" alt="image" src="Nondestructive detection of photonic/Image_020.png"/></span></p><p style="padding-left: 5pt;text-indent: 8pt;line-height: 112%;text-align: justify;">As NPQDs should preserve the qubit, polarization state tomography was conducted on the outgoing photonic qubits and compared with the incoming qubits. With this we calculate the fidelity ℱ = ⟨<i>Ψ</i><span class="s42">in</span>|<i>ρ</i><span class="s42">out</span>|<i>Ψ</i><span class="s42">in</span><a href="#bookmark11" class="s14">⟩. Six orthogonal polarization states were tomographically investigated (Fig. 2</a>b), showing an overall mean state fidelity of ℱ<span class="s47">a</span><span class="s9">ll </span>= (96.2± 0.3)%</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: justify;">conditioned on a nondestructive qubit detection. Our fidelity, here</p><p class="s46" style="padding-left: 5pt;text-indent: 0pt;line-height: 111%;text-align: justify;"><span class="p">for |</span><span class="s43">α</span><span class="p">|</span>2<span class="s13"> </span><a href="#bookmark39" class="s14">= 0.2, greatly exceeds the upper limit of the fidelity 2/3 or 5/6 which is possible for schemes employing 1 → ∞ or 1 → 2 universal quan- tum cloning machines, respectively</a>30<a href="#bookmark40" class="s14">. Note that the limits must be slightly shifted to 67.5% (ref. </a>31<span class="p">) and 84.9%, owing to higher photon number contributions of weak coherent pulses. Against this backdrop we conclude that our NPQD operates in the quantum regime.</span></p><p style="padding-left: 5pt;text-indent: 8pt;line-height: 114%;text-align: justify;">A major contribution to the infidelity comes from a polarization rotation around the <i>A</i>/<i>D </i>axis, attributed to a residual birefringence of the qubit cavity (see Methods). The mean fidelity for rotated and</p><p class="s60" style="padding-left: 121pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="10" height="1" alt="image" src="Nondestructive detection of photonic/Image_021.png"/></span>	<span><img width="10" height="1" alt="image" src="Nondestructive detection of photonic/Image_022.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 106%;text-align: justify;">non-rotated states is given by ℱ<span class="s47">HVRL</span><span class="s9"> </span>and ℱ<span class="s47">A</span><span class="s9">D</span><a href="#bookmark11" class="s14">, respectively (Fig. 2</a>c). However, taking into account this rotation in the calculation (which would be experimentally feasible by placing retardation waveplates</p><p class="s48" style="padding-left: 45pt;text-indent: 0pt;line-height: 6pt;text-align: center;">0          0.25       0.50    0           0.4         0.8     0          0.5         1.0</p><p class="s48" style="padding-top: 1pt;padding-left: 51pt;text-indent: 0pt;text-align: center;">Time (<span class="s51">µ</span>s)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s39" style="padding-left: 11pt;text-indent: 0pt;line-height: 121%;text-align: left;"><a name="bookmark2"><b>Fig. 2 | Experimental NPQD implementation. a</b></a><a href="#bookmark10" class="s61">, Time histogram showing the NPQD sequence, which includes the microwave pulses, the reflected qubit photon events (green) and the state-detection photon events. Red (blue) coloured state-detection counts represent data conditioned on a reflected photonic qubit detection (without an incoming photonic qubit). Labels I–IV refer to the Bloch spheres in Fig. </a>1e. <b>b</b>, Poincaré sphere showing the result of state tomography (coloured spheres) for reflected photonic qubits that were nondestructively detected.  <u>L</u>abels indicate input<a name="bookmark11">&zwnj;</a></p><p class="s39" style="padding-left: 11pt;text-indent: 0pt;line-height: 6pt;text-align: left;">polarizations. <b>c</b>, Bar chart of mean fidelities ℱ<span class="s63">x</span><span class="s64"> </span>and the quantum process</p><p style="text-indent: 0pt;text-align: left;"><span><img width="10" height="1" alt="image" src="Nondestructive detection of photonic/Image_023.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="10" height="1" alt="image" src="Nondestructive detection of photonic/Image_024.png"/></span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 112%;text-align: justify;">after the qubit cavity) leads to an overall mean state fidelity of ℱ<span class="s65">↺</span>= (98.0 ± 0.3)% (orange bar). The remaining 2% infidelity is attrib- uted to errors in the calibration of the qubit measurement setup and to fluctuations of the qubit cavity resonance frequency. Additionally, a quantum process is reconstructed via a maximum-likelihood fit, leading to an overall mean state fidelity of ℱ<span class="s47">s</span><span class="s9">,</span><span class="s66">χ </span>= (96.3± 0.6)%.</p><p style="padding-left: 6pt;text-indent: 8pt;line-height: 8pt;text-align: left;">Another important property of an NPQD is to preserve the temporal</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 114%;text-align: justify;"><a href="#bookmark11" class="s14">waveform of the photonic qubit (Fig. </a>2d). This is of great importance in scenarios where photons interfere or where quantum information is encoded in the temporal mode of the photon in addition to, or instead</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 54pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="8" height="1" alt="image" src="Nondestructive detection of photonic/Image_025.png"/></span></p><p class="s39" style="padding-left: 11pt;text-indent: 0pt;line-height: 3pt;text-align: left;">state fidelity ℱ</p><p class="s39" style="padding-top: 4pt;padding-left: 3pt;text-indent: 0pt;line-height: 5pt;text-align: left;">. The Poincaré sphere shows a rotation around the <i>A</i>/<i>D </i>axis</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">of, the polarization. To illustrate that our NPQD preserves the wave-</p><p class="s67" style="padding-left: 59pt;text-indent: 0pt;line-height: 5pt;text-align: left;">s,<i>χ                                         </i><u><i>      </i></u></p><p style="text-indent: 0pt;text-align: left;"><span><img width="8" height="1" alt="image" src="Nondestructive detection of photonic/Image_026.png"/></span></p><p class="s39" style="padding-left: 11pt;text-indent: 0pt;line-height: 115%;text-align: left;"><span class="s69">w</span>hich, if eliminated, leads to ℱ↺<span class="s69">.</span> <b>d</b>, The preservation of the photonic waveform is tested by reflecting photonic qubits with three different waveforms off the NPQD (blue points). Yellow points represent empty cavity measurements as reference. The error bars in <b>c </b>(<b>d</b>) describe the 1<i>σ </i>confidence interval (standard deviation). The error bar of ℱ<span class="s70">s</span><span class="s67">,</span><span class="s64">χ  </span>is assessed with a Monte Carlo method and represents the standard error.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 5pt;padding-left: 11pt;text-indent: 0pt;line-height: 114%;text-align: justify;">Coherent manipulation of the atomic ground states is achieved by means of microwave fields emitted by an antenna close to the fibre cavities. The microwave flips the atomic state in about 12 μs with a probability of (97 ± 1)% (see Methods). The detector herald signal is generated by a laser that, together with the state-detection cavity,</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 114%;text-align: justify;">form, we compare three different envelopes of qubit pulses reflected off our atom–cavity system (blue points) with pulses reflected off an empty cavity (yellow points). For all three cases we find an intensity waveform overlap between the outgoing and the incoming photon exceeding 99.5%.</p><p style="padding-left: 5pt;text-indent: 8pt;line-height: 9pt;text-align: left;">The mean input photon number |<i>α</i>|<span class="s46">2</span><span class="s13"> </span>of the weak coherent pulses</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;"><a href="#bookmark12" class="s14">encoding the qubit has a role in the performance of the NPQD. Its char- acterization is presented in Fig. </a>3 where different figures of merit of our detector are shown. For the given range of |<i>α</i>|<span class="s46">2 </span>in front of the qubit cavity, the nondestructive detection probability upon qubit survival <i>P</i>(0<span class="s42">a</span>|≥1<span class="s42">oq</span><a href="#bookmark12" class="s14">) (blue points in Fig. </a>3a) shows a maximum of (79 ± 3)% at</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: justify;">|<i>α</i>|<span class="s46">2</span><span class="s13"> </span>= 0.13. Here, the major error is attributed to a difference in intensity</p><p class="s47" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: justify;"><span class="p">reflection coefficients for acoupling(</span><span class="s43">R</span>|0<span class="s71">a</span>⟩<span class="s9"> </span><span class="p">= 0.50 ± 0.02) andanoncou-</span></p><p class="s46" style="padding-left: 11pt;text-indent: 0pt;line-height: 9pt;text-align: left;"><a href="#bookmark22" class="s14">induces cavity-enhanced fluorescence</a>9<span class="s13"> </span><span class="p">for typically 7.5 μs. The fluores-</span></p><p class="s47" style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;"><span class="p">pling atom(</span><span class="s43">R</span>|1<span class="s71">a</span>⟩</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;">= 0.117 ± 0.003); see Methods. For high |<i>α</i>|<span class="s72">2</span>, the condi-</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 8pt;text-align: justify;">cence photons are predominantly emitted into the cavity from where</p><p class="s46" style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;line-height: 110%;text-align: justify;"><a href="#bookmark35" class="s14">they are guided towards a single-photon detector. Note that both fibre cavities are single-sided (for details, see ref. </a>26<span class="p">), so that the dominant escape channels for cavity photons are the two single-mode fibres.</span></p><p style="padding-left: 11pt;text-indent: 8pt;line-height: 113%;text-align: justify;"><a href="#bookmark11" class="s14">We now characterize the nondestructive detection of photonic polarization qubits. For this, weak coherent pulses at the single-photon level were used. Figure </a>2a illustrates the NPQD temporal sequence by showing a time histogram of single-photon detector counts at the qubit measurement setup and the state-detection cavity output. The mean photon number here is |<i>α</i>|<span class="s46">2</span><span class="s13"> </span>= 0.13 in front of the qubit cavity. As can be seen, the reflection of photonic qubits at the NPQD (green bars) has a large effect on the number of observed state-detection photons (red</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: justify;">tional probability converges towards 0.5 owing to the balanced</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 108%;text-align: justify;"><a href="#bookmark41" class="s14">contribution of odd and even photon numbers</a><span class="s46">32</span>, and decreases for small |<i>α</i>|<span class="s46">2</span><span class="s13"> </span>values owing to dark counts of the qubit measurement set-up. The unconditional probability <i>P</i>(0<span class="s42">a</span>) (green points) shows the same convergence for high |<i>α</i>|<span class="s46">2</span>. However, in the limit of |<i>α</i>|<span class="s46">2</span><span class="s13"> </span>→ 0, the probabil- ity is lower-bounded by <i>p</i><span class="s42">DC</span><span class="s13"> </span>(grey dashed line), which is due to imperfec- tions in the atomic-state manipulation, in the optical pumping and in the state detection.</p><p style="padding-left: 5pt;text-indent: 8pt;line-height: 111%;text-align: justify;">Another important figure of merit is the probability of having a pho- tonic qubit at the NPQD output conditioned on its nondestructive detection, <i>P</i>(1<span class="s42">oq</span>|0<span class="s42">a</span>). Because we characterize the NPQD with weak coher- ent states (and not with single-photon Fock states), we instead show</p><p style="text-indent: 0pt;text-align: left;"><span><img width="0" height="926" alt="image" src="Nondestructive detection of photonic/Image_027.png"/></span></p><p class="s19" style="padding-top: 4pt;text-indent: 0pt;text-align: right;">a     <span class="s49">1.0</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Detection probability</p><p style="text-indent: 0pt;text-align: left;"/><p class="s48" style="text-indent: 0pt;text-align: right;">0.8</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="text-indent: 0pt;text-align: right;">0.6</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="text-indent: 0pt;text-align: right;">0.4</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="text-indent: 0pt;text-align: right;">0.2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s73" style="text-indent: 0pt;text-align: right;">b    <span class="s19"> </span><span class="s48">0.0</span></p><p class="s48" style="padding-top: 5pt;text-indent: 0pt;line-height: 7pt;text-align: right;">1.25</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="padding-left: 5pt;text-indent: 0pt;line-height: 7pt;text-align: left;">1.0</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="295" height="307" alt="image" src="Nondestructive detection of photonic/Image_028.png"/></span></p><p class="s48" style="padding-left: 5pt;text-indent: 0pt;line-height: 125%;text-align: left;"><i>P</i>(0<span class="s75">a</span>|≥1<span class="s75">oq</span>) <i>P</i>(0<span class="s75">a</span>)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="151" height="37" alt="image" src="Nondestructive detection of photonic/Image_029.png"/></span></p><p class="s76" style="padding-top: 6pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">a</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="108" height="116" alt="image" src="Nondestructive detection of photonic/Image_030.png"/></span></p><p class="s77" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Entanglement speed-up</p><p style="text-indent: 0pt;text-align: left;"/><p class="s78" style="padding-top: 6pt;padding-left: 14pt;text-indent: 66pt;text-align: left;">NPQD</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 14pt;text-indent: 0pt;text-align: left;">4</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-top: 5pt;padding-left: 14pt;text-indent: 0pt;text-align: left;">2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-top: 5pt;padding-left: 14pt;text-indent: 0pt;line-height: 7pt;text-align: left;">0</p><p class="s79" style="padding-left: 18pt;text-indent: 0pt;line-height: 7pt;text-align: left;">0             10            20</p><p class="s80" style="padding-left: 15pt;text-indent: 0pt;line-height: 5pt;text-align: center;">L <span class="s79">(km)</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s81" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">NPQD entanglement time (s)</p><p style="text-indent: 0pt;text-align: left;"/><p class="s82" style="text-indent: 5pt;line-height: 21pt;text-align: left;">HQM <span style=" color: #000;">10</span><span class="s83">6</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: left;">10<span class="s83">4</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: left;">10<span class="s83">2</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: left;">10<span class="s83">0</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s84" style="text-indent: 0pt;text-align: left;">10<span class="s85">–2</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s84" style="text-indent: 0pt;text-align: left;">10<span class="s85">–4</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="141" height="37" alt="image" src="Nondestructive detection of photonic/Image_031.png"/></span></p><p class="s86" style="padding-top: 2pt;padding-left: 10pt;text-indent: 0pt;text-align: left;">b<span class="s76"> </span><span class="s87">I</span><span class="s88"> </span><span class="s24">)</span></p><p class="s87" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">I<span class="s88"> </span><span class="s24">)</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="121" height="116" alt="image" src="Nondestructive detection of photonic/Image_032.png"/></span></p><p class="s87" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">I<span class="s88"> </span><span class="s24">)</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Qubit amplification</p><p style="text-indent: 0pt;text-align: left;"/><p class="s79" style="padding-top: 6pt;padding-left: 9pt;text-indent: 0pt;text-align: center;">10</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 24pt;text-indent: 0pt;text-align: left;">5</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 24pt;text-indent: 0pt;line-height: 6pt;text-align: left;">0</p><p class="s84" style="text-indent: 0pt;line-height: 7pt;text-align: right;">10<span class="s85">–2</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s84" style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: center;">10<span class="s85">–1</span></p><p class="s80" style="text-indent: 0pt;line-height: 5pt;text-align: center;">P</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">10<span class="s83">0</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s75" style="padding-left: 1pt;text-indent: 0pt;text-align: left;"><span class="s74">n</span>oq<span class="s48">(0</span>a<span class="s48">)</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s48" style="padding-top: 4pt;text-indent: 0pt;text-align: right;">1.00</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="text-indent: 0pt;text-align: right;">0.75</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 16pt;text-indent: 0pt;line-height: 3pt;text-align: left;"><span><img width="1" height="5" alt="image" src="Nondestructive detection of photonic/Image_033.png"/></span></p><p class="s48" style="padding-top: 4pt;text-indent: 0pt;text-align: right;">0.50</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="text-indent: 0pt;text-align: right;">0.25</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="text-indent: 0pt;line-height: 6pt;text-align: right;">0.00</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s74" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">g<span class="s89">(2)</span><span class="s48">(0)</span></p><p style="text-indent: 0pt;text-align: left;"/><p class="s48" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0.5</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0.0</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s90" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">10<span class="s57">–1</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">|<span class="s91">a</span>|<span class="s89">2</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s48" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">10<span class="s89">0</span></p><p class="s85" style="text-indent: 0pt;line-height: 4pt;text-align: right;">iq</p></li><li style="padding-left: 136pt;text-indent: -130pt;line-height: 7pt;text-align: left;"><p class="s76" style="display: inline;">d</p><p style="text-indent: 0pt;text-align: left;"><span><img width="161" height="154" alt="image" src="Nondestructive detection of photonic/Image_034.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="156" height="35" alt="image" src="Nondestructive detection of photonic/Image_035.png"/></span></p><p class="s87" style="padding-left: 22pt;text-indent: 0pt;line-height: 8pt;text-align: left;">I<span class="s88"> </span><span class="s24">)</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="text-indent: 0pt;text-align: center;">QMS</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="128" height="95" alt="image" src="Nondestructive detection of photonic/Image_036.png"/></span></p><p class="s79" style="padding-left: 15pt;text-indent: 0pt;text-align: left;">10<span class="s83">3</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">SNR gain</p><p style="text-indent: 0pt;text-align: left;"/><p class="s79" style="padding-left: 15pt;text-indent: 0pt;text-align: left;">10<span class="s83">2</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 15pt;text-indent: 0pt;text-align: left;">10<span class="s83">1</span></p><p class="s48" style="padding-left: 92pt;text-indent: 0pt;line-height: 8pt;text-align: center;">10<span class="s89">–1                                                       </span><span class="s57"> </span>10<span class="s89">0</span></p><p class="s48" style="padding-left: 92pt;text-indent: 0pt;text-align: center;">|<span class="s91">a</span>|<span class="s89">2</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s38" style="padding-left: 11pt;text-indent: 0pt;line-height: 121%;text-align: left;"><a name="bookmark3">Fig. 3 | Characterization with different mean input photon numbers. a</a><span class="s39">, Nondestructive detection probability as a function of the mean input</span><a name="bookmark12">&zwnj;</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s79" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">10<span class="s83">0</span></p><p class="s79" style="padding-top: 4pt;padding-left: 15pt;text-indent: 0pt;line-height: 8pt;text-align: center;">0          2          4          6          8</p><p class="s80" style="padding-left: 14pt;text-indent: 0pt;line-height: 8pt;text-align: center;">L <span class="s79">(km)</span></p><p class="s92" style="text-indent: 0pt;line-height: 4pt;text-align: left;">a</p><p style="text-indent: 0pt;text-align: left;"/><p class="s92" style="text-indent: 0pt;line-height: 4pt;text-align: left;">oq</p><p style="text-indent: 0pt;text-align: left;"/><p class="s39" style="padding-left: 11pt;text-indent: 0pt;line-height: 8pt;text-align: left;">photon number |<i>α</i>|<span class="s93">2</span><span class="s92"> </span>in front of the qubit cavity. <i>P</i>(0 |≥1</p><p class="s39" style="text-indent: 0pt;text-align: left;">) is conditioned on a</p><p class="s38" style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;"><a name="bookmark4">Fig. 4 | NPQD applications. a</a><span class="s39">, Entanglement generation between an atom–</span><a name="bookmark13">&zwnj;</a></p><p class="s39" style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;line-height: 110%;text-align: left;">successful qubit reflection (≥1<span class="s41">oq</span>), whereas <i>P</i>(0<span class="s41">a</span>) is unconditioned. The horizontal dashed line represents the NPQD dark-count probability <i>p</i><span class="s41">DC</span>. <b>b</b>, Mean photon number at the qubit cavity output conditioned on a</p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="1" alt="image" src="Nondestructive detection of photonic/Image_037.png"/></span></p><p class="s39" style="padding-left: 11pt;text-indent: 0pt;line-height: 112%;text-align: left;">nondestructive detection event <i>n</i><span class="s70">oq</span>(0<span class="s70">a</span>). Inset, the autocorrelation function <i>g</i><span class="s93">(2)</span>(<i>τ </i>= 0) of the nondestructively detected qubits. All solid data points are taken with Gaussian photon pulse shapes and linear near-vertical polarization.</p><p class="s39" style="padding-left: 11pt;text-indent: 0pt;line-height: 119%;text-align: left;"><a href="#bookmark11" class="s61">Open circle (square) data points were taken with orthogonal polarization (different pulse shapes; Fig. </a>2c). For all plots the solid line is given by theoretical simulations described in Supplementary Information. The dashed line in <b>b </b>considers <i>p</i><span class="s41">DC</span><span class="s92"> </span>= 0. The error bars in <b>a </b>represent the 1<i>σ </i>confidence interval. The error bars in <b>b </b>and the inset to <b>b </b>represent the standard error and the standard deviation, respectively.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="1" alt="image" src="Nondestructive detection of photonic/Image_038.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="1" alt="image" src="Nondestructive detection of photonic/Image_039.png"/></span></p><p class="s9" style="text-indent: 0pt;line-height: 6pt;text-align: left;">oq     a</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 11pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark12" class="s14">in Fig. </a>3b the conditioned mean photon number, <i>n</i><span class="s47">oq</span>(0<span class="s47">a</span>), which is equivalent to <i>P</i>(1<span class="s42">oq</span>|0<span class="s42">a</span>) for small input photon numbers. We observe <i>n  </i>(0 )= 0.56 ± 0.02 for |<i>α</i>|<span class="s72">2</span><span class="s13"> </span>= 0.2, but this value decreases for smaller</p><p class="s39" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 121%;text-align: left;">photon entanglement source and a heralded quantum memory (HQM). An NPQD along the transmission channel can speed up the mean sender–receiver entanglement time compared to the standard situation. The blue and green coloured lines represent the entanglement speed-up and the NPQD entanglement time, respectively. <b>b</b>, Photonic qubits are remotely sent to a receiver for a follow-up operation that involves precious resources (for example, long-distance entanglement). The qubit amplification gives the ratio of the probability of having a photon after its nondestructive detection at the</p><p class="s39" style="padding-left: 5pt;text-indent: 0pt;line-height: 116%;text-align: left;">NPQD to the probability of having a photon before detection (<i>P</i><span class="s41">iq</span>). <b>c</b>, Photonic qubits transfer to a noisy qubit measurement set-up (QMS). Gating the QMS with the NPQD herald signal improves the SNR. <b>d</b>, Bell test based on</p><p class="s39" style="padding-left: 5pt;text-indent: 0pt;line-height: 121%;text-align: left;"><a href="#bookmark19" class="s61">precertification of the photon’s presence</a><span class="s93">6</span>. The dashed lines in the plots represent the situation of a perfect NPQD (<b>a</b>, <b>c</b>) or a dark-count-free NPQD (<b>b</b>).</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;line-height: 114%;text-align: left;">Our nondestructive detector (solid lines) outperforms direct transmis- sion at channel distances greater than or equal to 14 km, whereas a</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 9pt;text-align: left;">|<i>α</i>|<span class="s46">2</span>, owing to the NPQD dark counts <i>p</i></p><p class="s42" style="text-indent: 0pt;line-height: 10pt;text-align: left;">DC<span class="p">. The simulation that considers</span></p><p class="s13" style="text-indent: 0pt;line-height: 2pt;text-align: right;">2</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">perfect NPQD (dashed lines) would provide an advantage at any dis-</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 9pt;text-align: justify;"><i>p</i><span class="s42">DC</span><span class="s13"> </span>= 0 (dashed line), converges towards <i>P</i>(1<span class="s42">oq</span>|0<span class="s42">a</span>) = 52.3% for |<i>α</i>| → 0.</p><p class="s46" style="padding-left: 11pt;text-indent: 0pt;line-height: 111%;text-align: justify;"><a href="#bookmark12" class="s14">This value is below one because of parasitic losses of the cavity mirrors, imperfect mode matching and a finite atomic decay rate. Interestingly, not only the mean photon number but also the photon statistics change after qubit reflection (Fig. </a><span class="p">3b, inset). We prove this by measuring the second-order autocorrelation function at zero time delay, </span><span class="s43">g</span>(2)<span class="p">(0), of the reflected qubits conditioned on their nondestructive detection. The obtained sub-Poissonian statistics </span><span class="s43">g</span>(2)<a href="#bookmark41" class="s14">(0) &lt; 1 originates from the distillation of single photons out of the incoming weak coherent pulse (see Supplementary Information and ref. </a>32<span class="p">).</span></p><p class="s46" style="padding-left: 11pt;text-indent: 8pt;line-height: 113%;text-align: justify;"><a href="#bookmark13" class="s14">To explore the potential of our NPQD, we discuss now four exemplary applications that would benefit from our detector (details in Methods). Figure 4a, b illustrates situations in which monitoring the qubit loss along a transmission channel saves time and precious resources. The first example (Fig. </a><a href="#bookmark22" class="s14">4a) consists of an atom–photon entanglement source</a>9<span class="s13"> </span><a href="#bookmark35" class="s14">that sends photonic qubits to a heralded quantum memory</a>26<span class="s13"> </span><span class="p">to generate sender–receiver entanglement. The plot shows the entan- glement speed-up defined as the ratio of the mean entanglement gen- eration time without the nondestructive detector to that with the</span></p><p class="s9" style="padding-left: 7pt;text-indent: 0pt;line-height: 1pt;text-align: center;">NPQD</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: justify;"><a href="#bookmark13" class="s14">tance. The second example (Fig. </a>4b) describes a situation in which it is</p><p class="s13" style="text-indent: 0pt;line-height: 5pt;text-align: left;">iq</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: justify;">more efficient to perform a complex operation on an input photonic qubit only if this qubit has survived the transmission through a lossy channel. This can be accomplished by placing an NPQD right before the operating node. One example for a complex operation is quantum teleportation of the photonic qubit by means of previously established long-distance entanglement. A good figure of merit is the ratio of the probability of having a reflected qubit photon after nondestructive detection <i>P</i>(1<span class="s42">oq</span>|0<span class="s42">a</span>) to the probability of having an incoming qubit pho- ton <i>P </i><a href="#bookmark33" class="s14">, usually called qubit amplification</a><span class="s46">24</span>. The qubit amplification is substantially higher than one for <i>P</i><span class="s42">iq </span>≪ 1 and would notably improve in the absence of NPQD dark counts (dashed line).</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 8pt;line-height: 114%;text-align: justify;"><a href="#bookmark13" class="s14">Another group of applications refers to situations in which NPQDs can improve a subsequent photonic qubit measurement. Figure </a>4c shows a scenario in which photonic qubits are sent to a remote receiver that uses noisy detectors for the qubit measurement. An NPQD right before the receiver enables measurement of the qubit only when it is not lost, reducing the impact of measurement noise. This is of particu- lar interest for quantum key distribution, because the dark-count noise</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 10pt;text-align: left;">nondestructive detector,<i>T</i><span class="s47">ent</span>/<i>T </i><span class="s47">ent</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">, versus the channel length <i>L</i>. The</p><p class="s9" style="padding-left: 17pt;text-indent: 0pt;line-height: 2pt;text-align: center;">NPQD</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">of classical detectors is an important limitation on the quantum key</p><p style="text-indent: 0pt;line-height: 2pt;text-align: center;"><a href="#bookmark27" class="s12">14</a></p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 10pt;text-align: left;">position of the detector was chosen such that <i>T </i><span class="s47">ent</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">is minimal.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">rate for large distribution distances  . The signal-to-noise ratio (SNR)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="0" height="954" alt="image" src="Nondestructive detection of photonic/Image_040.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="695" height="0" alt="image" src="Nondestructive detection of photonic/Image_041.png"/></span></p><h2 style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">Article</h2><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="1" alt="image" src="Nondestructive detection of photonic/Image_042.png"/></span></p><p class="s9" style="text-indent: 0pt;line-height: 6pt;text-align: left;">oq     a</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-top: 6pt;padding-left: 11pt;text-indent: 0pt;line-height: 111%;text-align: justify;">gain is defined as the ratio of the SNR with an NPQD to that without an NPQD, SNR<span class="s42">NP</span><span class="s13">QD</span>/SNR, and exceeds one for a sender–receiver distance <i>L </i><a href="#bookmark13" class="s14">&gt; 1 km. For longer distances, this ratio converges towards approxi- mately seven, which could be raised with lower NPQD dark counts (illustrated by the dashed line, which considers perfect NPQD param- eters). A last example relates to loophole-free Bell tests (Fig. </a><a href="#bookmark19" class="s14">4d). As proposed previously</a><span class="s46">6</span>, the herald signals of NPQDs could allow two parties to be certain that they share an entangled photon pair right before the measurement, helping to close the detection loophole. The important parameter here is the photonic qubit reflection probability conditioned on its nondestructive detection. From our experiment we find <i>n </i>(0 )= 0.56 ± 0.02 for an input |<i>α</i>|<span class="s72">2</span><span class="s13"> </span><a href="#bookmark12" class="s14">= 0.2 (Fig. </a><a href="#bookmark42" class="s14">3b). This value exceeds the minimum detection efficiency of 43% (assuming no detec- tor background noise) which is required for a detection-loophole-free asymmetric Bell test</a><span class="s46">33</span>.</p><p style="padding-left: 11pt;text-indent: 8pt;line-height: 114%;text-align: justify;">In conclusion, we have demonstrated a nondestructive detector for photonic polarization qubits. We anticipate that it should also work with time-bin qubits. The main features are a conditional detection efficiency of up to (79 ± 3)% and a qubit preservation fidelity of at least (96.2 ± 0.3)%. None of the observed limitations seems fundamental. Most importantly, we present four possible applications that would benefit from our present device, to which we still expect to make improvements. This creates confidence that our detector will turn out to be a useful tool in near-future quantum communication links and fundamental tests of quantum physics.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h4 style="padding-left: 11pt;text-indent: 0pt;text-align: left;"><a name="bookmark5">Online content</a></h4><p style="padding-top: 3pt;padding-left: 11pt;text-indent: 0pt;line-height: 114%;text-align: justify;"><a href="https://doi.org/10.1038/s41586-021-03290-z" class="s14" target="_blank">Any methods, additional references, Nature Research reporting sum- maries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contri- butions and competing interests; and statements of data and code avail- ability are available at https://doi.org/10.1038/s41586-021-032</a>90-z.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l2"><li style="padding-top: 4pt;padding-left: 25pt;text-indent: -14pt;line-height: 106%;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark14">Bennett, C. &amp; DiVincenzo, D. Quantum information and computation. </a><i>Nature </i><span class="s96">404</span>, 247–255 (2000).<a name="bookmark15">&zwnj;</a></p></li><li style="padding-left: 25pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark16">Zhong, M. et al. Optically addressable nuclear spins in a solid with a six-hour coherence time. </a><i>Nature </i><span class="s96">517</span>, 177–180 (2015).</p></li><li style="padding-left: 25pt;text-indent: -14pt;line-height: 8pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark17">Gisin, N. &amp; Thew, R. Quantum communication. </a><i>Nat. Photon</i>. <span class="s96">1</span>, 165–171 (2007).</p></li><li style="padding-left: 25pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark18">Minář, J., de Riedmatten, H. &amp; Sangouard, N. Quantum repeaters based on heralded qubit amplifiers. </a><i>Phys. Rev. A </i><span class="s96">85</span>, 032313 (2012).</p></li><li style="padding-left: 25pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark19">Boone, K. et al. Entanglement over global distances via quantum repeaters with satellite links. </a><i>Phys. Rev. A </i><span class="s96">91</span>, 052325 (2015).</p></li><li style="padding-left: 25pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark20">Cabello, A. &amp; Sciarrino, F. Loophole-free Bell test based on local precertification of photon’s presence. </a><i>Phys. Rev. X </i><span class="s96">2</span>, 021010 (2012).</p></li><li style="padding-left: 25pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark21">Gisin, N., Pironio, S. &amp; Sangouard, N. Proposal for implementing device-independent quantum key distribution based on a heralded qubit amplifier. </a><i>Phys. Rev. Lett</i>. <span class="s96">105</span>, 070501 (2010).</p></li><li style="padding-left: 25pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark22">Brassard, G., Lütkenhaus, N., Mor, T. &amp; Sanders, B. C. Limitations on practical quantum cryptography. </a><i>Phys. Rev. Lett</i>. <span class="s96">85</span>, 1330–1333 (2000).</p></li><li style="padding-left: 25pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;">Reiserer, A. &amp; Rempe, G. Cavity-based quantum networks with single atoms and optical photons. <i>Rev. Mod. Phys</i>. <span class="s96">87</span>, 1379–1418 (2015).</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li style="padding-top: 3pt;padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark23">Hensen, B. et al. Loophole-free Bell inequality violation using electron spins separated 1.3 kilometres. </a><i>Nature </i><span class="s96">526</span>, 682–686 (2015).<a name="bookmark24">&zwnj;</a></p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;">Giustina, M. et al. Significant-loophole-free test of Bell’s theorem with entangled photons.</p><p class="s16" style="padding-left: 20pt;text-indent: 0pt;line-height: 8pt;text-align: left;"><a name="bookmark25"><i>Phys. Rev. Lett</i></a>. <span class="s96">115</span>, 250401 (2015).</p></li><li style="padding-left: 20pt;text-indent: -14pt;line-height: 106%;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark26">Liao, S.-K. et al. Satellite-relayed intercontinental quantum network. </a><i>Phys. Rev. Lett</i>. <span class="s96">120</span>, 030501 (2018).</p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark27">Van Loock, P. et al. Extending quantum links: modules for fiber- and memory-based quantum repeaters. </a><i>Adv. Quantum Technol</i>. <span class="s96">3</span>, 1900141 (2020).</p></li><li style="padding-left: 20pt;text-indent: -14pt;line-height: 8pt;text-align: left;"><p class="s16" style="display: inline;">Scarani, V. et al. The security of practical quantum key distribution. <i>Rev. Mod. Phys</i>. <span class="s96">81</span>,</p><p class="s16" style="padding-left: 20pt;text-indent: 0pt;text-align: left;"><a name="bookmark28">1301–1350 (2009).</a></p></li><li style="padding-top: 1pt;padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;">Grangier, P., Levenson, J. A. &amp; Poizat, J.-P. Quantum non-demolition measurements in optics. <i>Nature </i><span class="s96">396</span>, 537–542 (1998).</p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;">Guerlin, C. et al. Progressive field-state collapse and quantum non-demolition photon counting. <i>Nature </i><span class="s96">448</span>, 889–893 (2007).</p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark29">Johnson, B. R. et al. Quantum non-demolition detection of single microwave photons in a circuit. </a><i>Nat. Phys</i>. <span class="s96">6</span>, 663–667 (2010).</p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;">Reiserer, A., Ritter, S. &amp; Rempe, G. Nondestructive detection of an optical photon. <i>Science</i></p><p class="s96" style="padding-left: 20pt;text-indent: 0pt;text-align: left;">342<span class="s16">, 1349–1351 (2013).</span></p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;">Kono, S., Koshino, K., Tabuchi, Y., Noguchi, A. &amp; Nakamura, Y. Quantum non-demolition detection of an itinerant microwave photon. <i>Nat. Phys</i>. <span class="s96">14</span>, 546–549 (2018).</p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark30">Besse, J.-C. et al. Single-shot quantum nondemolition detection of individual itinerant microwave photons. </a><i>Phys. Rev. X </i><span class="s96">8</span>, 021003 (2018).</p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark31">Lee, M. et al. Ion-based quantum sensor for optical cavity photon numbers. </a><i>Phys. Rev. Lett</i>. <span class="s96">122</span>, 153603 (2019).</p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark32">Sinclair, N. et al. Proposal and proof-of-principle demonstration of non-destructive detection of photonic qubits using a Tm:LiNbO</a><span class="s97">3</span><span class="s98"> </span>waveguide. <i>Nat. Commun</i>. <span class="s96">7</span>, 13454 (2016).</p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;">Meyer-Scott, E. et al. Certifying the presence of a photonic qubit by splitting it in two.</p><p class="s16" style="padding-left: 20pt;text-indent: 0pt;text-align: left;"><a name="bookmark33"><i>Phys. Rev. Lett</i></a>. <span class="s96">116</span>, 070501 (2016).</p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark34">Kocsis, S., Xiang, G., Ralph, T. &amp; Pryde, G. Heralded noiseless amplification of a photon polarization qubit. </a><i>Nat. Phys</i>. <span class="s96">9</span>, 23–28 (2013).</p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark35">Kalb, N., Reiserer, A., Ritter, S. &amp; Rempe, G. Heralded storage of a photonic quantum bit in a single atom. </a><i>Phys. Rev. Lett</i>. <span class="s96">114</span>, 220501 (2015).</p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark36">Brekenfeld, M., Niemietz, D., Christesen, J. D. &amp; Rempe, G. A quantum network node with crossed optical fibre cavities. </a><i>Nat. Phys</i>. <span class="s96">16</span>, 647–651 (2020).</p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark37">Knill, E., Laflamme, R. &amp; Milburn, G. A scheme for efficient quantum computation with linear optics. </a><i>Nature </i><span class="s96">409</span>, 46–52 (2001).</p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark38">Duan, L.-M. &amp; Kimble, H. J. Scalable photonic quantum computation through cavity-assisted interactions. </a><i>Phys. Rev. Lett</i>. <span class="s96">92</span>, 127902 (2004).</p></li><li style="padding-left: 20pt;text-indent: -14pt;line-height: 8pt;text-align: left;"><p class="s16" style="display: inline;">Hunger, D. et al. A fiber Fabry–Perot cavity with high finesse. <i>New J. Phys</i>. <span class="s96">12</span>, 065038</p><p class="s16" style="padding-left: 20pt;text-indent: 0pt;text-align: left;"><a name="bookmark39">(2010).</a></p></li><li style="padding-left: 20pt;text-indent: -14pt;line-height: 106%;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark40">Scarani, V., Iblisdir, S., Gisin, N. &amp; Acín, A. Quantum cloning. </a><i>Rev. Mod. Phys</i>. <span class="s96">77</span>, 1225–1256 (2005).</p></li><li style="padding-left: 20pt;text-indent: -14pt;line-height: 8pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark41">Specht, H. et al. A single-atom quantum memory. </a><i>Nature </i><span class="s96">473</span>, 190–193 (2011).</p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark42">Daiss, S., Welte, S., Hacker, B., Li, L. &amp; Rempe, G. Single-photon distillation via a photonic parity measurement using cavity QED. </a><i>Phys. Rev. Lett</i>. <span class="s96">122</span>, 133603 (2019).</p></li><li style="padding-left: 20pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;">Brunner, N., Gisin, N., Scarani, V. &amp; Simon, C. Detection loophole in asymmetric Bell experiments. <i>Phys. Rev. Lett</i>. <span class="s96">98</span>, 220403 (2007).</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s96" style="padding-left: 6pt;text-indent: 0pt;line-height: 106%;text-align: left;">Publisher’s note <span class="s16">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="57" height="20" alt="image" src="Nondestructive detection of photonic/Image_043.png"/></span></p><p class="s96" style="padding-left: 50pt;text-indent: 0pt;text-align: left;">Open Access <span class="s16">This article is licensed under a Creative Commons Attribution</span></p><p class="s16" style="padding-left: 50pt;text-indent: 0pt;line-height: 116%;text-align: left;">4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate</p><p class="s16" style="padding-left: 6pt;text-indent: 0pt;line-height: 116%;text-align: left;"><a href="http://creativecommons.org/licenses/by/4.0/" class="a" target="_blank">credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit http://creativecommons.org/licenses/by/4.</a>0/.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s16" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">© The Author(s) 2021</p><p style="text-indent: 0pt;text-align: left;"><span><img width="0" height="926" alt="image" src="Nondestructive detection of photonic/Image_044.png"/></span></p><h3 style="padding-top: 2pt;padding-left: 11pt;text-indent: 0pt;text-align: justify;">Methods</h3><p class="s99" style="padding-top: 8pt;padding-left: 11pt;text-indent: 0pt;text-align: justify;">NPQD experimental sequence</p><p style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;line-height: 113%;text-align: justify;"><a href="#bookmark35" class="s14">The experiment starts with a two-second-long loading phase of a single atom into the crossing point of the two fibre-cavity modes (details in ref. </a><span class="s46">26</span>). A magneto-optical trap with <span class="s46">87</span>Rb atoms is loaded approximately 10 mm above the fibres and is released such that the laser-cooled atoms fall towards the intracavity region. At the crossing point of the two cavity modes there is a three-dimensional optical lattice where single atoms are trapped. The lattice consists of two blue-detuned intracav- ity traps (774.6 nm and 776.5 nm wavelength) and one red-detuned standing-wave optical dipole trap (799.2 nm wavelength), detuned with respect to the <i>D </i>line and with a trap depth of <i>U</i><span class="s42">0</span>/<i>k</i><span class="s42">B</span><span class="s13"> </span>≈ 1 mK each (<i>k</i><span class="s42">B</span>, Boltzmann constant). A cooling beam comes in at an oblique angle and cools the single atoms in the trap, where they remain for a few seconds. Cooling light that is scattered by the atom into the state-detection cavity mode is subsequently detected with a single-photon detector so that the presence of single atoms is confirmed. Afterwards, the NPQD scheme runs with a repetition rate of 576 Hz. This sequence is divided into three parts: the atomic cooling, atomic-state preparation and the NPQD part. The temporal length of atomic cooling constitutes 97% of the fast sequence time. This high fraction goes along with a desired and small microwave duty cycle to minimize system heating and cavity shaking that is attributed to the applied microwave fields. However, during this long cooling time, we conduct six 3-μs-long sequences to generate single photons emitted by the atom. The recorded pho-</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;line-height: 114%;text-align: justify;">a Ramsey-type experiment (Extended Data Fig. 1c). We have applied two rectangularly shaped π/2 pulses with varying time gap in between. During the waiting time, the internal microwave clock is shifted by 100 kHz to distinguish the decoherence from small microwave detun- ings. Decoherence is then unambiguously detected by the shrinking visibility of the oscillations. Extended Data Fig. 1c shows how the vis- ibility decreases to the 1/e value (e, Euler’s number) after 121 μs, which we define as the coherence time. We suspect that the decoherence arises from the effects of a mechanical non-ground state cooled atom that is trapped via a near-resonant red-detuned optical dipole trap. Hence, the hyperfine ground states |<i>F </i>= 1⟩ and |<i>F </i><a href="#bookmark45" class="s14">= 2⟩ are differently a.c. Stark-shifted which leads to different trap frequencies and ultimately to non-degenerate ground state transition frequencies. This situa- tion can be improved by ground-state cooling of the single atom</a><span class="s46">35</span><span class="s13"> </span>or a further red-detuned (and therefore more powerful) optical dipole trap.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s99" style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">Atom–cavity interaction and conditional reflection</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 114%;text-align: justify;">One enabling ingredient for the NPQD is the polarization-independent strong coupling between the atom and the photonic qubit mediated by the qubit cavity. For characterization, reflection spectra were meas- ured (Extended Data Fig. 2a) with a probe field in a superposition of left and right circular polarization, once with an atom coupled to the cavity mode (blue points) and once without any atom (green points). In the figure, a probe field frequency of zero corresponds to the atomic transition frequency. The empty cavity spectrum yields a field decay</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 9pt;text-align: left;">ton counts are used to calculate the autocorrelation function <i>g</i><span class="s46">(2)</span>(0) =</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">rate of <i>κ</i><span class="s42">QC</span></p><p style="text-indent: 0pt;text-align: left;">= 2π × (34.6 ± 0.3) MHz at a qubit cavity length of 162 μm.</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 114%;text-align: justify;">1 − 1/<i>n</i>, to infer the number of trapped atoms <i>n</i>. The atom cooling is followed by a 30-μs-long optical pumping phase to prepare the atom in the Zeeman state |<i>F </i>= 1, <i>m</i><span class="s44">F </span>= 0⟩. Here, the applied laser fields are the</p><p class="s46" style="padding-left: 11pt;text-indent: 0pt;line-height: 8pt;text-align: justify;"><a href="#bookmark35" class="s14">same as described in ref. </a>26<span class="p">, except we do not apply the final 4-μs-long</span></p><p style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;line-height: 114%;text-align: justify;">π-polarized laser field used in that work. After optical pumping, the sequence starts with the NPQD scheme as reported in the main text. We have stated that for cavity-assisted state detection the state-detection</p><p class="s13" style="text-indent: 0pt;line-height: 5pt;text-align: left;">QC</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 5pt;text-indent: 0pt;line-height: 111%;text-align: justify;">The normal-mode spectrum provides  a  coupling  rate  of  <i>g  </i>= 2π × (18.6 ± 0.5) MHz which leads to—considering the atomic dipole decay rate of <i>γ </i>= 2π × 3 MHz—a cooperativity of <i>C </i>= <i>g</i><span class="s46">2</span>/(2<i>κ    γ</i>) =</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">1.67 ± 0.09. Note the difference between the intensity reflection coef-</p><p class="s47" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: justify;"><span class="p">ficients with(</span><span class="s43">R</span>|0<span class="s71">a</span>⟩<span class="s9"> </span><span class="p">= 0.50 ± 0.02) and without(</span><span class="s43">R</span>|1<span class="s71">a</span>⟩<span class="s9"> </span><span class="p">= 0.117 ± 0.003) a coupling atom, both close to zero detuning. The intensity reflection</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: justify;">coefficients at zero atom and cavity detuning can be calculated accord-</p><p style="text-indent: 0pt;text-align: left;"><span><img width="1" height="24" alt="image" src="Nondestructive detection of photonic/Image_045.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="51" height="24" alt="image" src="Nondestructive detection of photonic/Image_046.png"/></span></p><p class="s9" style="padding-left: 81pt;text-indent: 0pt;line-height: 3pt;text-align: center;">2</p><p style="padding-left: 11pt;text-indent: 0pt;text-align: left;">cavity is near-resonant with the atomic transition D<span class="s42">2</span>: |<i>F </i>= 2⟩ ↔ |<i>F</i>′ = 3⟩. Because the state-detection cavity exhibits an intentional polariza-</p><p style="text-indent: 0pt;line-height: 10pt;text-align: right;"><span class="s100">ing</span> to <i>R </i>=  1 − <i>μ</i><span class="s101">2</span><span class="s9">  </span><span class="s102">2</span><span class="s66">κ</span><span class="s103">QC</span><span class="s67">,1</span></p><p class="s9" style="text-indent: 0pt;line-height: 6pt;text-align: right;">fc   <i>κ</i><span class="s70">QC</span></p><p class="s9" style="text-indent: 0pt;text-align: center;">1</p><p class="s9" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">2<i>C </i>+ 1</p><p style="padding-top: 2pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">, which employs the cavity field decay rate</p><p class="s9" style="padding-top: 4pt;padding-left: 50pt;text-indent: 0pt;line-height: 4pt;text-align: left;">340 ppm</p><p class="s46" style="padding-left: 11pt;text-indent: 0pt;text-align: left;"><a href="#bookmark35" class="s14">tion mode splitting by more than four cavity linewidths</a>26<span class="p">, only the</span></p><p style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;line-height: 9pt;text-align: left;">π-polarization mode is near-resonant with the atomic transition; the</p><p style="text-indent: 0pt;text-align: left;"><span><img width="34" height="1" alt="image" src="Nondestructive detection of photonic/Image_047.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: left;">via the outcoupling mirror <i>κ</i><span class="s47">QC</span><span class="s9">,1 </span>= <i>κ</i><span class="s47">QC</span><span class="s9"> </span>× <span class="s104">430</span><span class="s9"> ppm </span>. The equation for the</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: left;">intensity reflection coefficient additionally considers the mode match-</p><p class="s13" style="text-indent: 0pt;line-height: 2pt;text-align: right;">–i0.03</p><p style="padding-top: 2pt;padding-left: 11pt;text-indent: 0pt;line-height: 8pt;text-align: left;">second polarization mode is blue-detuned.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: left;">ing between the fibre and the cavity mode, <i>μ</i><span class="s42">fc</span><span class="s13"> </span>= 0.92e</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">, with respect</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s99" style="padding-left: 11pt;text-indent: 0pt;text-align: justify;">Coherent atomic-state manipulation</p><p style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;line-height: 111%;text-align: justify;">The nondestructive detector scheme requires the coherent manipula- tion of the atomic ground states |<i>F </i>= 1, <i>m</i><span class="s44">F</span><span class="s45"> </span>= 0⟩ and |<i>F </i>= 2, <i>m</i><span class="s44">F </span><a href="#bookmark44" class="s14">= 0⟩. In our experiment this manipulation is done via microwave radiation. It is advantageous to use microwave fields as opposed to a Raman transi- tion with near-infrared radiation fields, as the latter is intrinsically less detuned from the excited states and therefore leads to a higher prob- ability of populating these, which causes decoherence processes</a><span class="s46">34</span>.</p><p style="padding-left: 11pt;text-indent: 8pt;line-height: 114%;text-align: justify;">A microwave antenna is placed inside the vacuum chamber a distance of &lt;2 cm from the crossing point of the fibre-cavity modes. The antenna consists of a single loop with a circumference of 4.4 cm, equal to the microwave field wavelength. A magnetic guiding field of 226.5 mG mag- nitude defines the quantization axis along the qubit cavity axis which</p><p class="s46" style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: justify;"><a href="#bookmark22" class="s14">to the equation provided in ref. </a>9<span class="p">. The difference between the coefficients</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 114%;text-align: justify;">constitutes a major error source of our nondestructive detector, which leads to a lower detection probability, as explained in the following.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="15" height="12" alt="image" src="Nondestructive detection of photonic/Image_048.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="15" height="12" alt="image" src="Nondestructive detection of photonic/Image_049.png"/></span></p><p style="padding-left: 5pt;text-indent: 8pt;line-height: 114%;text-align: justify;">The theoretical model given in Supplementary Information includes a detailed set of contributing imperfections of our NPQD. However, here we assume a perfect system detecting single photons with only the conditional reflection as imperfection to clarify its consequences for the detector. The NPQD scheme starts with the atom prepared in a superposition of two ground states|<i>Ψ</i><span class="s47">a</span><span class="s9">1</span>⟩= (|0<span class="s47">a</span>⟩ + |1<span class="s47">a</span>⟩)/ 2 which</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: justify;">ideally turns into|<i>Ψ</i><span class="s47">a</span><span class="s9">2</span>⟩= (|0<span class="s47">a</span>⟩ − |1<span class="s47">a</span>⟩)/  2 upon successful photon reflec-</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 114%;text-align: justify;">tion (blue and first red vector in Extended Data Fig. 2b). However, owing to the different cavity reflection coefficients corresponding to the two atomic states, the initial state turns into</p><p class="s47" style="padding-top: 6pt;padding-left: 10pt;text-indent: 0pt;line-height: 7pt;text-align: center;"><span class="s43">r</span>0<span class="p">|0</span>a<span class="p">⟩+ </span><span class="s43">r</span>1<span class="p">|1</span>a<span class="p">⟩</span></p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 114%;text-align: justify;">enables us to address a single ground state transition at a microwave pulse duration of 5.8 μs. Extended Data Fig. 1a shows a microwave spec- trum for an atom that is prepared in the state |<i>F </i>= 1, <i>m</i><span class="s44">F</span><span class="s45"> </span>= 0⟩ and which</p><p style="text-indent: 0pt;text-align: left;"><span><img width="61" height="19" alt="image" src="Nondestructive detection of photonic/Image_050.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: left;">|<i>Ψ</i><span class="s47">a</span><span class="s9">2</span>⟩ =</p><p style="padding-top: 6pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">|<i>r</i><span class="s47">0</span>|<span class="s101">2</span><span class="s9"> </span>+ |<i>r</i><span class="s47">1</span>|<span class="s101">2</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s9" style="padding-left: 5pt;text-indent: 0pt;line-height: 2pt;text-align: left;">iπ</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">(1)</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 8pt;text-align: left;">was subsequently driven with a microwave field of varying frequency</p><p style="text-indent: 0pt;text-align: left;"><span><img width="28" height="16" alt="image" src="Nondestructive detection of photonic/Image_051.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="27" height="16" alt="image" src="Nondestructive detection of photonic/Image_052.png"/></span></p><p class="s47" style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;"><span class="p">with </span><span class="s43">r</span>0<span class="s9"> </span><span class="p">=|   </span><span class="s43">R</span>|<span class="s9">0</span><span class="s71">a</span>⟩ <span class="p">| and </span><span class="s43">r</span>1<span class="s9"> </span><span class="p">=|   </span><span class="s43">R</span>|1<span class="s71">a</span>⟩ <span class="p">|e</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: left;">(first green vector). As <i>r</i><span class="s42">0</span><span class="s13"> </span>and <i>r</i><span class="s42">1</span><span class="s13"> </span>are</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 8pt;text-align: left;">and a rectangular pulse duration of 25 μs. Final cavity-assisted state</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">not only different in phase but also in magnitude, the atomic state leaves</p><p class="s13" style="text-indent: 0pt;line-height: 5pt;text-align: left;">1/2</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 11pt;text-indent: 0pt;text-align: left;">detection measures the population in state 5<span class="s46">2</span>S</p><p class="s43" style="padding-top: 1pt;text-indent: 0pt;text-align: left;">F <span class="p">= 2.</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">the equatorial plane of the Bloch sphere. A subsequent microwave π/2</p><p style="padding-top: 1pt;padding-left: 20pt;text-indent: 0pt;line-height: 5pt;text-align: left;">Choosing the related frequency enables the driving of the transition</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 7pt;text-align: left;">pulse rotates this state into|<i>Ψ  </i>⟩= <i>R</i><span class="s105">^</span> (π/2)|<i>Ψ  </i>⟩ which goes beyond the</p><p class="s9" style="text-indent: 0pt;line-height: 6pt;text-align: right;">a3           <i>a                    </i>a2</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 112%;text-align: justify;">of interest: |<i>F </i>= 1, <i>m</i><span class="s44">F</span><span class="s45"> </span>= 0⟩ ↔ |<i>F </i>= 2, <i>m</i><span class="s44">F</span><span class="s45"> </span>= 0⟩. The coherent Rabi flopping of these two states is shown in Extended Data Fig. 1b, revealing the π/2-pulse duration of 5.8 μs. One limitation that affects this coherent driving is decoherence, which leads to a shrinking of the visibility of the Rabi oscillations. To further characterize this effect, we performed</p><p class="s13" style="text-indent: 0pt;line-height: 5pt;text-align: left;">a    oq                 a       a3</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 5pt;text-indent: 0pt;line-height: 108%;text-align: justify;">pole |0<span class="s42">a</span>⟩ (second green vector) and therefore leads to a state that is not orthogonal to |1<span class="s42">a</span>⟩. The detection probability upon qubit reflection is then upper-bounded by <i>P</i>(0 |1 ) = |⟨0 |<i>Ψ </i>⟩|<span class="s46">2</span><span class="s13"> </span>= 89%. The further reduc- tion of this value that we observe is attributed to a group of imperfec- tions that are further discussed in Supplementary Information.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="0" height="954" alt="image" src="Nondestructive detection of photonic/Image_053.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="741" height="0" alt="image" src="Nondestructive detection of photonic/Image_054.png"/></span></p><h2 style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;text-align: justify;">Article</h2><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s99" style="padding-left: 11pt;text-indent: 0pt;text-align: justify;">Photonic qubit fidelity and cavity birefringence</p><p style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;line-height: 113%;text-align: justify;"><a href="#bookmark11" class="s14">As shown in Fig. </a><a href="#bookmark46" class="s14">2, the photonic polarization qubit experiences a small rotation after its nondestructive detection. This is due to the birefrin- gence of the qubit cavity, which originates from a small ellipticity of the fibre-cavity mirrors and leads to a polarization mode splitting</a><span class="s46">36</span><span class="s13"> </span>of a fifth of the qubit cavity linewidth. By means of a <i>λ</i>/2 retardation waveplate positioned after the cavity, all polarization states rotate such that the qubit cavity eigenmode polarizations at reflection rotate into polarizations <i>A </i>and <i>D </i>at the detection setup. We measure that a superposition of polarizations <i>A </i>and <i>D </i>experiences a rotation of 42° around the <i>A</i>/<i>D </i>axis on the Bloch sphere in the case of an empty cav-</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="text-indent: 0pt;line-height: 5pt;text-align: left;">att</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 5pt;text-indent: 0pt;line-height: 111%;text-align: justify;">are explained in this section. As the operating wavelength of our NPQD is 780 nm, we consider photonic qubits of this wavelength with a cor- responding fibre attenuation of <i>α    </i>= 4 dB km<span class="s46">−1</span>.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: justify;"><span class="s3">Situation 1. </span><a href="#bookmark13" class="s14">Situation 1 (Fig. </a>4a) describes long-distance entanglement between an atom–photon entanglement source and a heralded quan- tum memory. For simplicity we consider the ideal situation, in which the time required to entangle the two systems is given by the commu- nication time (for example, the time to distribute the entangled pho- tonic qubit plus the time to communicate back if the heralded storage succeeded). In such a situation the mean entanglement time is given by <i>T</i><span class="s42">ent</span><span class="s13"> </span>= 2<i>L</i>/(<i>cp</i><span class="s42">ent</span>), where <i>L </i>is the distance between sender and receiver,</p><p class="s66" style="text-indent: 0pt;line-height: 2pt;text-align: right;"><span class="s9">−</span>α<span class="s70">att</span>L<span class="s9">/10</span></p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 8pt;text-align: left;">ity. The detector scheme relies on an atom being in a superposition</p><p class="s43" style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: left;">c <span class="p">is the speed of light in an optical fibre and </span>p<span class="s42">ent</span><span class="s13"> </span><span class="p">= </span>η<span class="s42">AP</span><span class="p">10</span></p><p class="s43" style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: left;">η<span class="s42">H</span><span class="s13"> </span><span class="p">is</span></p><p class="s46" style="padding-left: 11pt;text-indent: 0pt;line-height: 112%;text-align: justify;"><a href="#bookmark35" class="s14">of a coupling and noncoupling state, and so the incoming photonic qubit does not experience this full rotation. A rotation angle of 19.6° is extracted from afit of the input and output polarization states which are measured by polarization state tomography (Extended Data Fig. 3a; the analysis follows the description of ref. </a>26<span class="p">). This rotation is also observed in Extended Data Fig. 3b, which shows the matrix of the related underly-</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 111%;text-align: justify;">the heralded entanglement distribution probability. This probability depends on the atom–photon entanglement source efficiency <i>η</i><span class="s42">AP</span>, the attenuation coefficient of the transmission channel <i>α</i>, and the herald- ing efficiency of the heralded quantum memory <i>η</i><span class="s42">H</span>.</p><p style="padding-left: 5pt;text-indent: 8pt;line-height: 9pt;text-align: left;">When an NPQD is inserted along the transmission channel at a dis-</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">tance <i>l </i>&lt; <i>L </i>from the sender, the mean entanglement time reads</p><p class="s46" style="padding-left: 11pt;text-indent: 0pt;line-height: 6pt;text-align: left;"><a href="#bookmark47" class="s14">ing quantum processes of the detector</a>37<span class="p">. The shown matrix is derived</span></p><p class="s43" style="padding-left: 5pt;text-indent: 0pt;line-height: 6pt;text-align: left;">T <span class="s101">NPQD</span><span class="s9"> </span><span class="p">= 2⟨</span>l<span class="p">⟩/(</span>cp<span class="s101">NP</span><span class="s9">QD</span><span class="p">). Compared with </span>T</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 5pt;text-align: left;">, the average communica-</p><p class="s9" style="text-indent: 0pt;line-height: 6pt;text-align: right;">ent</p><p class="s9" style="padding-left: 5pt;text-indent: 0pt;line-height: 6pt;text-align: left;">ent</p><p class="s13" style="padding-left: 5pt;text-indent: 0pt;line-height: 5pt;text-align: left;">ent</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 8pt;text-align: left;">from a maximum-likelihood fit with matrix element uncertainties that</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: left;">tion distance ⟨<i>l</i>⟩ replaces <i>L </i>and is given by ⟨<i>l</i>⟩ = <i>P</i>(0<span class="s42">a</span>)<i>L </i>+ [1 − <i>P</i>(0<span class="s42">a</span>)]</p><p class="s46" style="padding-left: 11pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><a href="#bookmark35" class="s14">are calculated according to ref. </a>26<span class="p">. Major contributing matrix elements</span></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">(<i>l </i>+ <i>t</i></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="text-indent: 0pt;text-align: left;">NPQD</p><p class="s43" style="text-indent: 0pt;text-align: left;">c<span class="p">/2). It has two terms: First, the NPQD may provide a nonde-</span></p><p style="padding-left: 11pt;text-indent: 0pt;text-align: left;">are <i>χ</i><span class="s42">0,0</span>, <i>χ</i><span class="s42">1</span><span class="s13">,0 </span>and <i>χ</i><span class="s42">0,</span><span class="s13">1</span>, illustrating the polarization rotation effect.</p><p style="padding-left: 11pt;text-indent: 8pt;line-height: 114%;text-align: justify;">In this Article we provide the mean state fidelities under the condi- tion of nondestructive detection. However, evaluation of unconditional SPD counts (for example, events from all photonic qubits reflected from the NPQD) reveals a reduction of the polarization state fidelity</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 10pt;text-align: left;">for cavity noneigenstate polarizations (compare ℱ<span class="s42">cond.</span><span class="s13"> </span>with ℱ<span class="s42">uncond.</span><span class="s13"> </span>in Extended Data Table 1). We attribute this to a partial entanglement</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 112%;text-align: justify;">structive detection event that goes along with the full distance <i>L</i>. Sec- ond, the NPQD does not detect any qubit photon, leading to a shortening of the effective distance to <i>l</i>. In this case, one has to consider the NPQD herald signal readout time <i>t</i><span class="s42">NP</span><span class="s13">QD</span>, which delays the subsequent classical communication. Both terms include the probability for a non- destructive detection event, which is</p><p style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;line-height: 3pt;text-align: left;">effect between the photonic polarization state and the atomic state,</p><p class="s43" style="padding-left: 5pt;text-indent: 0pt;line-height: 5pt;text-align: left;">P<span class="p">(0 )= </span>η</p><p class="s66" style="padding-left: 4pt;text-indent: 0pt;line-height: 5pt;text-align: left;"><span class="p">10</span><span class="s101">−</span>α<span class="s106">att</span><span class="s107">l</span> <span class="s9">/10</span><span class="s43">P</span><span class="p">(0 |1  )(1 − </span><span class="s43">p</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 5pt;text-align: left;">) + <i>p</i></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 5pt;text-align: left;">.                    (3)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 11pt;text-indent: 0pt;text-align: left;">because the polarization rotation preferably occurs when the atom is</p><p class="s108" style="padding-left: 5pt;text-indent: 0pt;line-height: 7pt;text-align: left;">a          <span class="s9"> AP</span></p><p class="s108" style="padding-left: 5pt;text-indent: 0pt;line-height: 7pt;text-align: left;">a   <span class="s9"> iq               DC           DC</span></p><p style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;line-height: 114%;text-align: left;">in the noncoupling state. This effect can be theoretically described as follows. An initial atomic superposition state and an incoming photonic</p><p style="padding-left: 5pt;text-indent: 8pt;line-height: 11pt;text-align: left;">It takes into account the nondestructive detection probability upon an incoming qubit <i>P</i>(0<span class="s42">a</span>|1<span class="s42">iq</span>) and the NPQD dark counts, <i>p</i><span class="s42">DC</span>. In addition</p><p class="s9" style="padding-left: 99pt;text-indent: 0pt;line-height: 2pt;text-align: center;">NPQD</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 8pt;text-align: left;">qubit lead to a partially entangled state after reflection,</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: left;">to the replacement of <i>L </i>by ⟨<i>l</i>⟩ in<i>T </i><span class="s47">ent</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">, one needs to provide the entan-</p><p class="s9" style="padding-left: 50pt;text-indent: 0pt;line-height: 2pt;text-align: left;">NPQD</p><p style="padding-left: 278pt;text-indent: 0pt;line-height: 6pt;text-align: left;">glement probability at the presence of an NPQD, <i>p</i><span class="s104">ent</span></p><p style="padding-left: 4pt;text-indent: 0pt;line-height: 6pt;text-align: left;">, which replaces</p><p style="padding-left: 89pt;text-indent: 0pt;line-height: 9pt;text-align: left;"><i>r</i><span class="s47">0</span>|<i>Ψ</i><span class="s47">p</span><span class="s9">h</span>⟩|0<span class="s47">a</span>⟩+ <i>r</i><span class="s47">1</span>(<i>R</i><span class="s105">^</span> ⊗ 1<span class="s105">^</span>)|<i>Ψ</i><span class="s47">p</span><span class="s9">h</span>⟩|1<span class="s47">a</span>⟩  </p><p class="s43" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 6pt;text-align: left;">p   <span class="p">. It is given by </span>p<span class="s101">NPQD</span><span class="s9"> </span><span class="p">= </span>p   P<span class="p">(0 |1  )</span>P<span class="p">(1   |0 ) that additionally con-</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: right;">|<i>Ψ </i>⟩ =</p><p style="text-indent: 0pt;text-align: left;"><span><img width="140" height="19" alt="image" src="Nondestructive detection of photonic/Image_055.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 7pt;text-align: left;">.                           (2)</p><p class="s13" style="padding-left: 5pt;text-indent: 0pt;line-height: 5pt;text-align: left;">ent</p><p class="s9" style="padding-left: 5pt;text-indent: 0pt;line-height: 6pt;text-align: left;">ent</p><p class="s109" style="padding-left: 5pt;text-indent: 0pt;line-height: 7pt;text-align: left;">ent        <span class="s9"> a    iq          oq     a</span></p><p class="s9" style="text-indent: 0pt;line-height: 6pt;text-align: left;">0             1</p><p style="text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;line-height: 10pt;text-align: right;"><a name="bookmark43">|</a><i>r </i>|<span class="s101">2</span><span class="s9"> </span>+ |<i>r </i>|<span class="s101">2</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">siders the NPQD inefficiency. These expressions at hand, we calculate</p><p class="s9" style="padding-left: 63pt;text-indent: 0pt;line-height: 2pt;text-align: center;">NPQD</p><p style="text-indent: 0pt;line-height: 10pt;text-align: right;">the entanglement time <i>T </i><span class="s47">ent</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">and compare it with the situation that</p><p style="padding-left: 11pt;text-indent: 8pt;text-align: justify;">|0<span class="s42">a</span>⟩ and |1<span class="s42">a</span>⟩ represent the coupling and non-coupling atomic states, respectively, and |<i>Ψ</i><span class="s42">ph</span>⟩ represents the photon polarization state, which experiences a rotation <i>R</i><span class="s100">ˆ</span> when the atom is in state |1<span class="s42">a</span>⟩. <i>r</i><span class="s42">0</span><span class="s13"> </span>and <i>r</i><span class="s42">1</span><span class="s13"> </span>describe the field reflection coefficients as used in Methods section</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 114%;text-align: justify;">‘Atom–cavity interaction and conditional reflection’. Moreover, we assume no qubit rotation in case of a coupling atom. When the atomic part is not observed, the entanglement translates into decoherence for the photonic qubit as shown by the shrinking sphere in Extended Data Fig. 3c. This situation holds true only for polarization states that experience a rotation due to the cavity birefringence. Because photonic polarizations <i>A </i>and <i>D </i><a href="#bookmark43" class="s14">do not rotate, for these polarizations the state in equation (</a>2) becomes separable and therefore follows the ideal situation.</p><p style="padding-left: 11pt;text-indent: 8pt;line-height: 114%;text-align: justify;"><a href="#bookmark12" class="s14">As mentioned previously, the polarization rotation leads to a qubit infidelity that could be overcome by means of retardation waveplates. However, in addition one would also expect a polarization depend- ency on the imprinted atomic phase shift at qubit reflection which would affect the nondestructive detection efficiency. We have tried to observe this effect by comparing the detector performance for dif- ferent incoming polarization states (Fig. </a>3), but do not find substantial</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">does not include a nondestructive detector <i>T</i><span class="s42">ent</span>, in order to obtain the entanglement speed-up. For both simulations we consider <i>η</i><span class="s42">AP</span><span class="s13"> </span>= 0.5 and <i>η</i><span class="s42">H</span><span class="s13"> </span><a href="#bookmark35" class="s14">= 0.11, which are realistic parameters that have been obtained in previous works</a><span class="s46">26</span><a href="#bookmark48" class="s12">,</a><span class="s13">38</span>.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 109%;text-align: justify;"><span class="s3">Situation 2. </span><a href="#bookmark13" class="s14">Situation 2 (Fig. </a>4b) describes qubit amplification for dif- ferent probabilities of input photon numbers. The qubit amplification <i>A</i><span class="s42">q</span><span class="s13"> </span>is defined as the ratio of the probability of having a photonic qubit at the output of the NPQD conditioned on its nondestructive detection <i>P</i>(1<span class="s42">oq</span>|0<span class="s42">a</span>) to the probability of having an input qubit <i>P</i><span class="s42">iq</span><a href="#bookmark12" class="s14">. These quantities are related to those shown in Fig. </a>3, from which the qubit amplification</p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="1" alt="image" src="Nondestructive detection of photonic/Image_056.png"/></span></p><p class="s13" style="text-indent: 0pt;line-height: 5pt;text-align: left;">2</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">is inferred as <i>A</i><span class="s47">q</span><span class="s9"> </span>= <i>n</i><span class="s47">oq</span>(0<span class="s47">a</span>)/|<i>α</i>|<span class="s101">2</span><span class="s9"> </span>for small |<i>α</i><a href="#bookmark13" class="s14">| . The data points shown in Fig. </a>4b are calculated according to this expression. To simulate the qubit amplification with our NPQD parameters (solid line) and without</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 114%;text-align: justify;">NPQD dark counts (dashed line), we use the theoretical model described in Supplementary Information.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 110%;text-align: justify;"><span class="s3">Situation 3. </span><a href="#bookmark13" class="s14">In situation 3 (Fig. </a>4c), remote photonic qubits are meas- ured with noisy detectors: an NPQD gates a qubit measurement in order to improve its signal-to-noise ratio, SNR = <i>p</i><span class="s42">s</span>/<i>p</i><span class="s42">n</span>. This gating reduces</p><p class="s9" style="padding-left: 99pt;text-indent: 0pt;line-height: 1pt;text-align: center;">NPQD</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 8pt;text-align: left;">differences in the NPQD performance. We attribute this observation</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">the noise detection probability to <i>p</i><span class="s104">n</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">= <i>P</i>(0<span class="s47">a</span>)<i>p</i><span class="s104">n</span>but also reduces the</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 8pt;text-align: left;">to the fact that the birefringence effect is relatively small compared to</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">signal, owing to the parasitic losses induced by the nondestructive</p><p class="s9" style="padding-left: 47pt;text-indent: 0pt;line-height: 2pt;text-align: left;">NPQD</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 8pt;text-align: left;">other imperfections, for example, the conditional reflection.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">detector, <i>p</i><span class="s104">s</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">= <i>p</i><span class="s104">s</span><i>P</i>(0<span class="s47">a</span>|1<span class="s47">i</span><span class="s9">q</span>)<i>P</i>(1<span class="s47">o</span><span class="s9">q</span>|0<span class="s47">a</span>). Additionally, we relate the non-</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s99" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">Theoretical models for NPQD applications</p><p style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;text-align: left;"><a href="#bookmark13" class="s14">In Fig. </a>4 we show simulations of specific situations in which our non-</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: left;">destructive detection probability with our NPQD parameters, <i>P</i>(0<span class="s42">a</span>) =</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><i>P</i>(0<span class="s42">a</span>|1<span class="s42">iq</span>)<i>p</i><span class="s42">s</span>(1 – <i>p</i><span class="s42">DC</span>) + <i>p</i><span class="s42">DC</span>, and consider that the input signal probability depends only on the transmission losses of the communication</p><p class="s66" style="padding-left: 62pt;text-indent: 0pt;line-height: 2pt;text-align: left;"><span class="s9">−</span>α<span class="s70">att</span>L<span class="s9">/10</span></p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 8pt;text-align: left;">destructive detector is advantageous. The details of these simulations</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: left;">channel, <i>p</i><span class="s42">s</span><span class="s13"> </span>= 10</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">. This enables us to calculate the SNR gain as a</p><p style="text-indent: 0pt;text-align: left;"><span><img width="0" height="926" alt="image" src="Nondestructive detection of photonic/Image_057.png"/></span></p><p style="padding-top: 3pt;padding-left: 11pt;text-indent: 0pt;line-height: 114%;text-align: left;">function of the communication distance <i>L</i>, considering an NPQD with our parameters (solid line) and a perfect NPQD (dashed line).</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h4 style="padding-left: 11pt;text-indent: 0pt;text-align: left;">Data availability</h4><p style="padding-top: 3pt;padding-left: 11pt;text-indent: 0pt;line-height: 114%;text-align: left;"><a href="https://doi.org/10.5281/zenodo.4381767" class="s14" target="_blank">The datasets generated during and/or analysed during the current study are available at https://doi.org/10.5281/zenodo.438176</a>7.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li style="padding-left: 25pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark44">Körber, M. et al. Decoherence-protected memory for a single-photon qubit. </a><i>Nat. Photon</i>.</p><p class="s96" style="padding-left: 25pt;text-indent: 0pt;text-align: left;"><a name="bookmark45">12</a><span class="s16">, 18–21 (2018).</span></p></li><li style="padding-left: 25pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark46">Reiserer, A., Nölleke, C., Ritter, S. &amp; Rempe, G. Ground-state cooling of a single atom at the center of an optical cavity. </a><i>Phys. Rev. Lett</i>. <span class="s96">110</span>, 223003 (2013).</p></li><li style="padding-left: 25pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;"><a name="bookmark47">Uphoff, M., Brekenfeld, M., Rempe, G. &amp; Ritter, S. Frequency splitting of polarization eigenmodes in microscopic Fabry–Perot cavities. </a><i>New J. Phys</i>. <span class="s96">17</span>, 013053 (2015).</p></li><li style="padding-left: 25pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;">Nielsen, M. A. &amp; Chuang, I. L. <i>Quantum Computation and Quantum Information</i></p><p class="s16" style="padding-top: 1pt;padding-left: 25pt;text-indent: 0pt;text-align: left;"><a name="bookmark48">(Cambridge Univ. Press, 2010).</a></p></li><li style="padding-top: 1pt;padding-left: 25pt;text-indent: -14pt;text-align: left;"><p class="s16" style="display: inline;">Ritter, S. et al. An elementary quantum network of single atoms in optical cavities. <i>Nature</i></p></li></ol></li></ol><p class="s96" style="padding-left: 25pt;text-indent: 0pt;text-align: left;">484<span class="s16">, 195–200 (2012).</span></p><p class="s96" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 106%;text-align: left;">Acknowledgements <span class="s16">We thank M. Brekenfeld and J. D. Christesen for contributions during an early stage of this work. This work was supported by Bundesministerium</span></p><p class="s16" style="padding-left: 5pt;text-indent: 0pt;line-height: 116%;text-align: left;">für Bildung und Forschung via Verbund Q.Link.X (grant number 16KIS0870), Deutsche Forschungsgemeinschaft under Germany’s Excellence Strategy (EXC-2111, 390814868) and the European Union’s Horizon 2020 Research and Innovation programme via the project Quantum Internet Alliance (GA number 820445). P.F. acknowledges support by the</p><p class="s16" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Cellex-ICFO-MPQ postdoctoral fellowship programme.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s96" style="padding-left: 5pt;text-indent: 0pt;line-height: 106%;text-align: left;">Author contributions <span class="s16">All authors contributed to the experiment, analysis of the results and writing of the manuscript.</span></p><p class="s96" style="padding-left: 5pt;text-indent: 0pt;line-height: 15pt;text-align: left;">Funding <span class="s16">Open access funding provided by Max Planck Society. </span>Competing interests <span class="s16">The authors declare no competing interests. </span>Additional information</p><p class="s96" style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">Supplementary information <span class="s16">The online version contains supplementary material available at</span></p><p class="s16" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="https://doi.org/10.1038/s41586-021-03290-z" class="a" target="_blank">https://doi.org/10.1038/s41586-021-03290-</a>z.</p><p class="s96" style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">Correspondence and requests for materials <span class="s16">should be addressed to D.N.</span></p><p class="s96" style="padding-left: 5pt;text-indent: 0pt;line-height: 106%;text-align: left;">Peer review information <span class="s95">Nature </span><span class="s16">thanks the anonymous reviewers for their contribution to the peer review of this work. Peer reviewer reports are available.</span></p><p class="s96" style="padding-left: 5pt;text-indent: 0pt;line-height: 8pt;text-align: left;">Reprints and permissions information <a href="http://www.nature.com/reprints" class="a" target="_blank">is available at http://</a><span class="s16">www.nature.com/reprints.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="0" height="954" alt="image" src="Nondestructive detection of photonic/Image_058.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="741" height="1" alt="image" src="Nondestructive detection of photonic/Image_059.png"/></span></p><h2 style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">Article</h2><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 15pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="329" height="559" alt="image" src="Nondestructive detection of photonic/Image_060.jpg"/></span></p><p class="s39" style="padding-top: 7pt;padding-left: 11pt;text-indent: 0pt;line-height: 117%;text-align: left;"><a name="bookmark6"><b>Extended Data Fig. 1 | Coherent microwave driving. a</b></a>, Microwave spectroscopy of an atom prepared in Zeeman state |<i>F </i>= 1, <i>m</i><span class="s110">F</span><span class="s111">  </span>= 0⟩. The light-blue curve is a fit consisting of three sinc<span class="s93">2 </span><span class="s92"> </span>functions. Fit parameters are centre and Rabi frequency of each transition whereas the pulse duration is fixed to 25 μs. The peak at 0 kHz corresponds to the |0<span class="s41">a</span>⟩ ↔ |1<span class="s41">a</span>⟩ transition. <b>b</b>, Microwave-driven Rabi oscillation on the |0<span class="s41">a</span>⟩ ↔ |1<span class="s41">a</span>⟩ transition for an atom prepared in state |0<span class="s41">a</span>⟩.</p><p class="s39" style="padding-left: 11pt;text-indent: 0pt;line-height: 8pt;text-align: left;"><b>c</b>, An atom prepared in state |0<span class="s41">a</span>⟩ is subsequently driven into a superposition of</p><p class="s39" style="padding-left: 11pt;text-indent: 0pt;line-height: 116%;text-align: left;">|0<span class="s41">a</span>⟩ and |1<span class="s41">a</span>⟩ by a microwave π/2 pulse. After a variable time a second microwave π/2 pulse is applied. During the waiting time the internal microwave clock is shifted by 100 kHz. Final state detection measures the population in |1<span class="s41">a</span>⟩. All error bars represent the 1<i>σ </i>confidence interval, some error bars are smaller than the symbol size.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="0" height="926" alt="image" src="Nondestructive detection of photonic/Image_061.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 14pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="332" height="163" alt="image" src="Nondestructive detection of photonic/Image_062.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s39" style="padding-top: 2pt;padding-left: 11pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><a name="bookmark7"><b>Extended Data Fig. 2 | Atom–cavity reflection spectra and the atomic state during the NPQD scheme. a</b></a>, Cavity reflection spectra of the qubit cavity with no atom (green points) and with a cavity mode that is strongly coupled to an atom prepared in the state |<i>F </i>= 1, <i>m</i><span class="s110">F</span><span class="s111"> </span>= 0⟩ (blue points). The solid lines represent fit functions and the error bars show the standard deviation. <b>b</b>, Bloch sphere with the atomic state (represented by vectors) at different stages of the detector scheme. The blue vector is the initial atomic state after the first π/2 microwave pulse. After photon reflection, the initial state turns into the red or green state (dotted arrow is a guide to the eye). Green and red states show the situation with and without conditional reflection, respectively. A subsequent microwave π/2 pulse rotates the atom to the final state (dashed arrow follows the rotation). State detection (not shown) then projects the atomic state onto</p><p class="s39" style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">|0<span class="s41">a</span>⟩ or |1<span class="s41">a</span>⟩.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="0" height="954" alt="image" src="Nondestructive detection of photonic/Image_063.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="741" height="1" alt="image" src="Nondestructive detection of photonic/Image_064.png"/></span></p><h2 style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">Article</h2><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="334" height="306" alt="image" src="Nondestructive detection of photonic/Image_065.jpg"/></span></p><p class="s38" style="padding-top: 7pt;padding-left: 11pt;text-indent: 0pt;line-height: 121%;text-align: left;"><a name="bookmark8">Extended Data Fig. 3 | Polarization state and quantum process tomography. a</a><span class="s39">, </span>c<span class="s39">, Poincaré sphere showing the underlying quantum process of our NPQD. The coloured spheres are the result of polarization state tomography for reflected photonic pulses for the correspondingly coloured and labelled input polarizations. </span>b<span class="s39">, </span>d<span class="s39">, NPQD underlying quantum process</span></p><p class="s39" style="padding-left: 11pt;text-indent: 0pt;line-height: 108%;text-align: left;">matrix <i>χ </i>which is reconstructed via a maximum-likelihood fit. <span class="s112">J</span><span class="s70">2</span><span class="s67"> </span>denotes the 2 × 2 identity matrix and <i>σ</i><span class="s110">x</span>, <i>σ</i><span class="s110">y</span><span class="s111"> </span>and <i>σ</i><span class="s110">z</span><span class="s111"> </span>denote the Pauli matrices. In <b>a </b>and <b>b</b>, the</p><p class="s39" style="padding-left: 11pt;text-indent: 0pt;line-height: 121%;text-align: left;">photon counts at the tomography setup are conditioned on the nondestructive qubit detection. In <b>c </b>and <b>d</b>, they are not conditioned on the nondestructive detection. The rotation around the <i>A</i>/<i>D </i>axis is described by an operator built</p><p class="s39" style="padding-left: 11pt;text-indent: 0pt;line-height: 110%;text-align: left;">by <i>σ</i><span class="s110">x</span>. The uncertainty of <i>χ</i><span class="s110">m,n</span><span class="s111"> </span>is assessed with a Monte Carlo method and represents the standard error.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="0" height="926" alt="image" src="Nondestructive detection of photonic/Image_066.png"/></span></p><p class="s113" style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;text-align: left;"><a name="bookmark9">Extended Data Table 1 | Photonic polarization qubit fidelities</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 10pt;text-align: left;"><span><img width="340" height="330" alt="image" src="Nondestructive detection of photonic/Image_067.gif"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="1" alt="image" src="Nondestructive detection of photonic/Image_068.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="1" alt="image" src="Nondestructive detection of photonic/Image_069.png"/></span></p><p class="s16" style="padding-top: 7pt;padding-left: 11pt;text-indent: 0pt;line-height: 9pt;text-align: left;">The polarization state fidelities, <span class="s114">ℱ</span><span class="s115">al</span><span class="s116">l </span>and <span class="s114">ℱ</span><span class="s117">o</span><span class="s118"> </span>are assigned with a 1<i>σ </i>confidence level accounting for statistical uncertainties due to the finite number of detected photons. The uncertainty of <span class="s114">ℱ</span><span class="s70">χ</span><span class="s67"> </span>is assessed with a Monte Carlo method and represents the standard error.</p><p class="s16" style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">*SPD counts are conditioned on the nondestructive qubit detection.</p><p class="s16" style="padding-top: 2pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">†SPD counts are unconditionally evaluated.</p><p class="s16" style="padding-top: 2pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">‡Mean value of all six input polarization states.</p><p class="s16" style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;text-align: left;"><span class="s15">§</span>An inverse unitary rotation around the <i>A</i>/<i>D </i>axis is applied to the measured output states before calculating the mean fidelity.</p><p class="s15" style="padding-top: 1pt;padding-left: 11pt;text-indent: 0pt;text-align: left;">¶<span class="s16">Quantum process fidelity.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 193pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="7" height="1" alt="image" src="Nondestructive detection of photonic/Image_070.png"/></span></p><p class="s114" style="padding-left: 11pt;text-indent: 0pt;text-align: left;"><span class="s16">**Mean state fidelity inferred from the quantum process fidelity via </span>ℱ<span class="s115">s</span><span class="s116">,</span><span class="s64">χ </span>= <span class="s16">(2</span>ℱ<span class="s63">χ</span><span class="s64"> </span>+ <span class="s16">1)/3.</span></p></body></html>
